import{g as kt}from"./_commonjsHelpers.CqkleIqs.js";var zt="ais",sn=function(t){return function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.descendantName,u=n.modifierName,s=r?"-".concat(r):"",f=u?"--".concat(u):"";return"".concat(zt,"-").concat(t).concat(s).concat(f)}},Jt=0;function Kt(e){e.dependsOn==="recommend"&&(e.$$id=Jt++)}function cn(){}var Gt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ht=/[&<>"']/g,Zt=RegExp(Ht.source);function Xt(e){return e&&Zt.test(e)?e.replace(Ht,function(t){return Gt[t]}):e}var Yt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},wt=/&(amp|quot|lt|gt|#39);/g,er=RegExp(wt.source);function un(e){return e&&er.test(e)?e.replace(wt,function(t){return Yt[t]}):e}function qe(e){"@babel/helpers - typeof";return qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(e)}function tr(e){return e===null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function rr(e){return qe(e)==="object"&&e!==null}function nr(e){if(!rr(e)||tr(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Y(e){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(e)}function ir(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function We(){return We=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},We.apply(this,arguments)}function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Je(Object(n),!0).forEach(function(r){At(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function At(e,t,n){return t=ar(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ar(e){var t=sr(e,"string");return Y(t)==="symbol"?t:String(t)}function sr(e,t){if(Y(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Y(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ke={highlightPreTag:"__ais-highlight__",highlightPostTag:"__/ais-highlight__"},ae={highlightPreTag:"<mark>",highlightPostTag:"</mark>"};function cr(e){return Xt(e).replace(new RegExp(Ke.highlightPreTag,"g"),ae.highlightPreTag).replace(new RegExp(Ke.highlightPostTag,"g"),ae.highlightPostTag)}function se(e){return nr(e)&&typeof e.value!="string"?Object.keys(e).reduce(function(t,n){return ne(ne({},t),{},At({},n,se(e[n])))},{}):Array.isArray(e)?e.map(se):ne(ne({},e),{},{value:cr(e.value)})}function on(e){return e.__escaped===void 0&&(e=e.map(function(t){var n=We({},(ir(t),t));return n._highlightResult&&(n._highlightResult=se(n._highlightResult)),n._snippetResult&&(n._snippetResult=se(n._snippetResult)),n}),e.__escaped=!0),e}function ur(e){return btoa(encodeURIComponent(JSON.stringify(e)))}function or(e){return JSON.parse(decodeURIComponent(atob(e)))}function $(e){return e.$$type==="ais.index"}function fr(e){var t=e.name,n=e.connector,r=n===void 0?!1:n;return["https://www.algolia.com/doc/api-reference/widgets/",t,"/js/",r?"#connector":""].join("")}function hr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map(function(u){return fr(u)}).join(", ");return function(u){return[u,"See documentation: ".concat(r)].filter(Boolean).join(`

`)}}function fn(e,t){for(var n,r=0;r<e.length;r++)if(n=e[r],t(n,r,e))return n}function lr(e,t){if(!Array.isArray(e))return-1;for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}function hn(e){var t=ae.highlightPostTag,n=ae.highlightPreTag,r=e.split(n),u=r.shift(),s=u?[{value:u,isHighlighted:!1}]:[];return r.forEach(function(f){var h=f.split(t);s.push({value:h[0],isHighlighted:!0}),h[1]!==""&&s.push({value:h[1],isHighlighted:!1})}),s}function ln(e,t){var n=Array.isArray(t)?t:t.split(".");return n.reduce(function(r,u){return r&&r[u]},e)}function Ge(e){return e!==Object(e)}function dr(e,t){if(e===t)return!0;if(Ge(e)||Ge(t)||typeof e=="function"||typeof t=="function")return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n=0,r=Object.keys(e);n<r.length;n++){var u=r[n];if(!(u in t)||!dr(e[u],t[u]))return!1}return!0}function mr(e){return e.filter(function(t,n,r){return r.indexOf(t)===n})}function ee(e){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}var vr=["facets","disjunctiveFacets","facetsRefinements","facetsExcludes","disjunctiveFacetsRefinements","numericRefinements","tagRefinements","hierarchicalFacets","hierarchicalFacetsRefinements","ruleContexts"];function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ze(Object(n),!0).forEach(function(r){gr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gr(e,t,n){return t=pr(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pr(e){var t=Rr(e,"string");return ee(t)==="symbol"?t:String(t)}function Rr(e,t){if(ee(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ee(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yr(e,t){if(e==null)return{};var n=Fr(e,t),r,u;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(u=0;u<s.length;u++)r=s[u],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Fr(e,t){if(e==null)return{};var n={},r=Object.keys(e),u,s;for(s=0;s<r.length;s++)u=r[s],!(t.indexOf(u)>=0)&&(n[u]=e[u]);return n}var Pr=function(t,n){n.facets,n.disjunctiveFacets,n.facetsRefinements,n.facetsExcludes,n.disjunctiveFacetsRefinements,n.numericRefinements,n.tagRefinements,n.hierarchicalFacets,n.hierarchicalFacetsRefinements,n.ruleContexts;var r=yr(n,vr);return t.setQueryParameters(r)},_r=function(t,n){return n.facets.reduce(function(r,u){return r.addFacet(u)},t)},jr=function(t,n){return n.disjunctiveFacets.reduce(function(r,u){return r.addDisjunctiveFacet(u)},t)},Sr=function(t,n){return t.setQueryParameters({hierarchicalFacets:n.hierarchicalFacets.reduce(function(r,u){var s=lr(r,function(h){return h.name===u.name});if(s===-1)return r.concat(u);var f=r.slice();return f.splice(s,1,u),f},t.hierarchicalFacets)})},br=function(t,n){return n.tagRefinements.reduce(function(r,u){return r.addTagRefinement(u)},t)},xr=function(t,n){return t.setQueryParameters({facetsRefinements:M(M({},t.facetsRefinements),n.facetsRefinements)})},Er=function(t,n){return t.setQueryParameters({facetsExcludes:M(M({},t.facetsExcludes),n.facetsExcludes)})},Or=function(t,n){return t.setQueryParameters({disjunctiveFacetsRefinements:M(M({},t.disjunctiveFacetsRefinements),n.disjunctiveFacetsRefinements)})},Hr=function(t,n){return t.setQueryParameters({numericRefinements:M(M({},t.numericRefinements),n.numericRefinements)})},wr=function(t,n){return t.setQueryParameters({hierarchicalFacetsRefinements:M(M({},t.hierarchicalFacetsRefinements),n.hierarchicalFacetsRefinements)})},Ar=function(t,n){var r=mr([].concat(t.ruleContexts).concat(n.ruleContexts).filter(Boolean));return r.length>0?t.setQueryParameters({ruleContexts:r}):t},Tr=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce(function(u,s){var f=wr(u,s),h=Sr(f,s),p=br(h,s),g=Hr(p,s),y=Or(g,s),b=Er(y,s),o=xr(b,s),i=jr(o,s),a=Ar(i,s),m=_r(a,s);return Pr(m,s)})};function ie(e,t,n){var r=t.getHelper();return{uiState:n,helper:r,parent:t,instantSearchInstance:e,state:r.state,renderState:e.renderState,templatesConfig:e.templatesConfig,createURL:t.createURL,scopedResults:[],searchMetadata:{isSearchStalled:e.status==="stalled"},status:e.status,error:e.error}}function Xe(e,t,n){var r=t.getResultsForWidget(n),u=t.getHelper();return{helper:u,parent:t,instantSearchInstance:e,results:r,scopedResults:t.getScopedResults(),state:r&&"_state"in r?r._state:u.state,renderState:e.renderState,templatesConfig:e.templatesConfig,createURL:t.createURL,searchMetadata:{isSearchStalled:e.status==="stalled"},status:e.status,error:e.error}}function Qr(e){for(var t=e.getParent(),n=[e.getHelper().state];t!==null;)n=[t.getHelper().state].concat(n),t=t.getParent();return n}function Be(e){"@babel/helpers - typeof";return Be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(e)}function dn(e){var t=e.getAttribute("data-insights-method"),n=e.getAttribute("data-insights-payload");if(typeof n!="string")throw new Error("The insights helper expects `data-insights-payload` to be a base64-encoded JSON string.");try{var r=or(n);return{method:t,payload:r}}catch{throw new Error("The insights helper was unable to parse `data-insights-payload`.")}}function Ir(e){var t=e.method,n=e.payload;if(Be(n)!=="object")throw new Error("The insights helper expects the payload to be an object.");var r;try{r=ur(n)}catch{throw new Error("Could not JSON serialize the payload object.")}return'data-insights-method="'.concat(t,'" data-insights-payload="').concat(r,'"')}function mn(e,t){return Ir({method:e,payload:t})}var oe,Ye;function Tt(){if(Ye)return oe;Ye=1;function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}oe=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(s){if(!n(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},e.prototype.emit=function(s){var f,h,p,g,y,b;if(this._events||(this._events={}),s==="error"&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(f=arguments[1],f instanceof Error)throw f;var o=new Error('Uncaught, unspecified "error" event. ('+f+")");throw o.context=f,o}if(h=this._events[s],u(h))return!1;if(t(h))switch(arguments.length){case 1:h.call(this);break;case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:g=Array.prototype.slice.call(arguments,1),h.apply(this,g)}else if(r(h))for(g=Array.prototype.slice.call(arguments,1),b=h.slice(),p=b.length,y=0;y<p;y++)b[y].apply(this,g);return!0},e.prototype.addListener=function(s,f){var h;if(!t(f))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,t(f.listener)?f.listener:f),this._events[s]?r(this._events[s])?this._events[s].push(f):this._events[s]=[this._events[s],f]:this._events[s]=f,r(this._events[s])&&!this._events[s].warned&&(u(this._maxListeners)?h=e.defaultMaxListeners:h=this._maxListeners,h&&h>0&&this._events[s].length>h&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(s,f){if(!t(f))throw TypeError("listener must be a function");var h=!1;function p(){this.removeListener(s,p),h||(h=!0,f.apply(this,arguments))}return p.listener=f,this.on(s,p),this},e.prototype.removeListener=function(s,f){var h,p,g,y;if(!t(f))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(h=this._events[s],g=h.length,p=-1,h===f||t(h.listener)&&h.listener===f)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,f);else if(r(h)){for(y=g;y-- >0;)if(h[y]===f||h[y].listener&&h[y].listener===f){p=y;break}if(p<0)return this;h.length===1?(h.length=0,delete this._events[s]):h.splice(p,1),this._events.removeListener&&this.emit("removeListener",s,f)}return this},e.prototype.removeAllListeners=function(s){var f,h;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(f in this._events)f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[s],t(h))this.removeListener(s,h);else if(h)for(;h.length;)this.removeListener(s,h[h.length-1]);return delete this._events[s],this},e.prototype.listeners=function(s){var f;return!this._events||!this._events[s]?f=[]:t(this._events[s])?f=[this._events[s]]:f=this._events[s].slice(),f},e.prototype.listenerCount=function(s){if(this._events){var f=this._events[s];if(t(f))return 1;if(f)return f.length}return 0},e.listenerCount=function(s,f){return s.listenerCount(f)};function t(s){return typeof s=="function"}function n(s){return typeof s=="number"}function r(s){return typeof s=="object"&&s!==null}function u(s){return s===void 0}return oe}var fe,et;function Qt(){if(et)return fe;et=1;function e(t,n){t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}return fe=e,fe}var he,tt;function Dr(){if(tt)return he;tt=1;var e=Tt(),t=Qt();function n(r,u,s){this.main=r,this.fn=u,this.recommendFn=s,this.lastResults=null,this.lastRecommendResults=null}return t(n,e),n.prototype.detach=function(){this.removeAllListeners(),this.main.detachDerivedHelper(this)},n.prototype.getModifiedState=function(r){return this.fn(r)},n.prototype.getModifiedRecommendState=function(r){return this.recommendFn(r)},he=n,he}var le,rt;function Ue(){if(rt)return le;rt=1;function e(n){return typeof n!="string"?n:String(n).replace(/^-/,"\\-")}function t(n){return typeof n!="string"?n:n.replace(/^\\-/,"-")}return le={escapeFacetValue:e,unescapeFacetValue:t},le}var de,nt;function ce(){if(nt)return de;nt=1;function e(u){return typeof u=="object"&&u!==null?n(Array.isArray(u)?[]:{},u):u}function t(u){return typeof u=="function"||Array.isArray(u)||Object.prototype.toString.call(u)==="[object Object]"}function n(u,s){if(u===s)return u;for(var f in s)if(!(!Object.prototype.hasOwnProperty.call(s,f)||f==="__proto__"||f==="constructor")){var h=s[f],p=u[f];typeof p<"u"&&typeof h>"u"||(t(p)&&t(h)?u[f]=n(p,h):u[f]=e(h))}return u}function r(u){t(u)||(u={});for(var s=1,f=arguments.length;s<f;s++){var h=arguments[s];t(h)&&n(u,h)}return u}return de=r,de}var me,it;function Ve(){if(it)return me;it=1;function e(t){return t&&Object.keys(t).length>0}return me=e,me}var ve,at;function $e(){if(at)return ve;at=1;function e(t,n){if(t===null)return{};var r={},u=Object.keys(t),s,f;for(f=0;f<u.length;f++)s=u[f],!(n.indexOf(s)>=0)&&(r[s]=t[s]);return r}return ve=e,ve}var ge,st;function It(){if(st)return ge;st=1;function e(t){t=t||{},this.params=t.params||[]}return e.prototype={constructor:e,addParams:function(t){var n=this.params.slice();return n.push(t),new e({params:n})},removeParams:function(t){return new e({params:this.params.filter(function(n){return n.$$id!==t})})},addFrequentlyBoughtTogether:function(t){return this.addParams(Object.assign({},t,{model:"bought-together"}))},addRelatedProducts:function(t){return this.addParams(Object.assign({},t,{model:"related-products"}))},addTrendingItems:function(t){return this.addParams(Object.assign({},t,{model:"trending-items"}))},addTrendingFacets:function(t){return this.addParams(Object.assign({},t,{model:"trending-facets"}))},addLookingSimilar:function(t){return this.addParams(Object.assign({},t,{model:"looking-similar"}))},_buildQueries:function(t,n){return this.params.filter(function(r){return n[r.$$id]===void 0}).map(function(r){var u=Object.assign({},r,{indexName:t,threshold:r.threshold||0});return delete u.$$id,u})}},ge=e,ge}var pe,ct;function Dt(){if(ct)return pe;ct=1;function e(t,n){this._state=t,this._rawResults={};var r=this;t.params.forEach(function(u){var s=u.$$id;r[s]=n[s],r._rawResults[s]=n[s]})}return e.prototype={constructor:e},pe=e,pe}var Re,ut;function Cr(){if(ut)return Re;ut=1;var e=ce();function t(r){return Object.keys(r).sort().reduce(function(u,s){return u[s]=r[s],u},{})}var n={_getQueries:function(u,s){var f=[];return f.push({indexName:u,params:n._getHitsSearchParams(s)}),s.getRefinedDisjunctiveFacets().forEach(function(h){f.push({indexName:u,params:n._getDisjunctiveFacetSearchParams(s,h)})}),s.getRefinedHierarchicalFacets().forEach(function(h){var p=s.getHierarchicalFacetByName(h),g=s.getHierarchicalRefinement(h),y=s._getHierarchicalFacetSeparator(p);if(g.length>0&&g[0].split(y).length>1){var b=g[0].split(y).slice(0,-1).reduce(function(i,a,m){return i.concat({attribute:p.attributes[m],value:m===0?a:[i[i.length-1].value,a].join(y)})},[]);b.forEach(function(o,i){var a=n._getDisjunctiveFacetSearchParams(s,o.attribute,i===0);function m(l){return p.attributes.some(function(P){return P===l.split(":")[0]})}var v=(a.facetFilters||[]).reduce(function(l,P){if(Array.isArray(P)){var x=P.filter(function(j){return!m(j)});x.length>0&&l.push(x)}return typeof P=="string"&&!m(P)&&l.push(P),l},[]),c=b[i-1];i>0?a.facetFilters=v.concat(c.attribute+":"+c.value):v.length>0?a.facetFilters=v:delete a.facetFilters,f.push({indexName:u,params:a})})}}),f},_getHitsSearchParams:function(r){var u=r.facets.concat(r.disjunctiveFacets).concat(n._getHitsHierarchicalFacetsAttributes(r)).sort(),s=n._getFacetFilters(r),f=n._getNumericFilters(r),h=n._getTagFilters(r),p={};return u.length>0&&(p.facets=u.indexOf("*")>-1?["*"]:u),h.length>0&&(p.tagFilters=h),s.length>0&&(p.facetFilters=s),f.length>0&&(p.numericFilters=f),t(e({},r.getQueryParams(),p))},_getDisjunctiveFacetSearchParams:function(r,u,s){var f=n._getFacetFilters(r,u,s),h=n._getNumericFilters(r,u),p=n._getTagFilters(r),g={hitsPerPage:0,page:0,analytics:!1,clickAnalytics:!1};p.length>0&&(g.tagFilters=p);var y=r.getHierarchicalFacetByName(u);return y?g.facets=n._getDisjunctiveHierarchicalFacetAttribute(r,y,s):g.facets=u,h.length>0&&(g.numericFilters=h),f.length>0&&(g.facetFilters=f),t(e({},r.getQueryParams(),g))},_getNumericFilters:function(r,u){if(r.numericFilters)return r.numericFilters;var s=[];return Object.keys(r.numericRefinements).forEach(function(f){var h=r.numericRefinements[f]||{};Object.keys(h).forEach(function(p){var g=h[p]||[];u!==f&&g.forEach(function(y){if(Array.isArray(y)){var b=y.map(function(o){return f+p+o});s.push(b)}else s.push(f+p+y)})})}),s},_getTagFilters:function(r){return r.tagFilters?r.tagFilters:r.tagRefinements.join(",")},_getFacetFilters:function(r,u,s){var f=[],h=r.facetsRefinements||{};Object.keys(h).sort().forEach(function(b){var o=h[b]||[];o.slice().sort().forEach(function(i){f.push(b+":"+i)})});var p=r.facetsExcludes||{};Object.keys(p).sort().forEach(function(b){var o=p[b]||[];o.sort().forEach(function(i){f.push(b+":-"+i)})});var g=r.disjunctiveFacetsRefinements||{};Object.keys(g).sort().forEach(function(b){var o=g[b]||[];if(!(b===u||!o||o.length===0)){var i=[];o.slice().sort().forEach(function(a){i.push(b+":"+a)}),f.push(i)}});var y=r.hierarchicalFacetsRefinements||{};return Object.keys(y).sort().forEach(function(b){var o=y[b]||[],i=o[0];if(i!==void 0){var a=r.getHierarchicalFacetByName(b),m=r._getHierarchicalFacetSeparator(a),v=r._getHierarchicalRootPath(a),c,l;if(u===b){if(i.indexOf(m)===-1||!v&&s===!0||v&&v.split(m).length===i.split(m).length)return;v?(l=v.split(m).length-1,i=v):(l=i.split(m).length-2,i=i.slice(0,i.lastIndexOf(m))),c=a.attributes[l]}else l=i.split(m).length-1,c=a.attributes[l];c&&f.push([c+":"+i])}}),f},_getHitsHierarchicalFacetsAttributes:function(r){var u=[];return r.hierarchicalFacets.reduce(function(f,h){var p=r.getHierarchicalRefinement(h.name)[0];if(!p)return f.push(h.attributes[0]),f;var g=r._getHierarchicalFacetSeparator(h),y=p.split(g).length,b=h.attributes.slice(0,y+1);return f.concat(b)},u)},_getDisjunctiveHierarchicalFacetAttribute:function(r,u,s){var f=r._getHierarchicalFacetSeparator(u);if(s===!0){var h=r._getHierarchicalRootPath(u),p=0;return h&&(p=h.split(f).length),[u.attributes[p]]}var g=r.getHierarchicalRefinement(u.name)[0]||"",y=g.split(f).length-1;return u.attributes.slice(0,y+1)},getSearchForFacetQuery:function(r,u,s,f){var h=f.isDisjunctiveFacet(r)?f.clearRefinements(r):f,p={facetQuery:u,facetName:r};return typeof s=="number"&&(p.maxFacetHits=s),t(e({},n._getHitsSearchParams(h),p))}};return Re=n,Re}var ye,ot;function Me(){return ot||(ot=1,ye=function(){var t=Array.prototype.slice.call(arguments);return t.reduceRight(function(n,r){return Object.keys(Object(r)).forEach(function(u){r[u]!==void 0&&(n[u]!==void 0&&delete n[u],n[u]=r[u])}),n},{})}),ye}var Fe,ft;function re(){return ft||(ft=1,Fe=function(t,n){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(n(t[r]))return t[r]}}),Fe}var Pe,ht;function Nr(){if(ht)return Pe;ht=1;function e(t,n){return t.filter(function(r,u){return n.indexOf(r)>-1&&t.indexOf(r)===u})}return Pe=e,Pe}var _e,lt;function qr(){if(lt)return _e;lt=1;function e(t){if(typeof t=="number")return t;if(typeof t=="string")return parseFloat(t);if(Array.isArray(t))return t.map(e);throw new Error("The value should be a number, a parsable string or an array of those.")}return _e=e,_e}var je,dt;function Wr(){return dt||(dt=1,je=function(t){return t===null?!1:/^[a-zA-Z0-9_-]{1,64}$/.test(t)}),je}var Se,mt;function Br(){if(mt)return Se;mt=1;var e=Me(),t=Ve(),n=$e(),r={addRefinement:function(s,f,h){if(r.isRefined(s,f,h))return s;var p=""+h,g=s[f]?s[f].concat(p):[p],y={};return y[f]=g,e({},y,s)},removeRefinement:function(s,f,h){if(h===void 0)return r.clearRefinement(s,function(g,y){return f===y});var p=""+h;return r.clearRefinement(s,function(g,y){return f===y&&p===g})},toggleRefinement:function(s,f,h){if(h===void 0)throw new Error("toggleRefinement should be used with a value");return r.isRefined(s,f,h)?r.removeRefinement(s,f,h):r.addRefinement(s,f,h)},clearRefinement:function(s,f,h){if(f===void 0)return t(s)?{}:s;if(typeof f=="string")return n(s,[f]);if(typeof f=="function"){var p=!1,g=Object.keys(s).reduce(function(y,b){var o=s[b]||[],i=o.filter(function(a){return!f(a,b,h)});return i.length!==o.length&&(p=!0),y[b]=i,y},{});return p?g:s}},isRefined:function(s,f,h){var p=!!s[f]&&s[f].length>0;if(h===void 0||!p)return p;var g=""+h;return s[f].indexOf(g)!==-1}};return Se=r,Se}var be,vt;function Ct(){if(vt)return be;vt=1;var e=Me(),t=re(),n=Nr(),r=ce(),u=Ve(),s=$e(),f=qr(),h=Wr(),p=Br();function g(o,i){return Array.isArray(o)&&Array.isArray(i)?o.length===i.length&&o.every(function(a,m){return g(i[m],a)}):o===i}function y(o,i){return t(o,function(a){return g(a,i)})}function b(o){var i=o?b._parseNumbers(o):{};i.userToken!==void 0&&!h(i.userToken)&&console.warn("[algoliasearch-helper] The `userToken` parameter is invalid. This can lead to wrong analytics.\n  - Format: [a-zA-Z0-9_-]{1,64}"),this.facets=i.facets||[],this.disjunctiveFacets=i.disjunctiveFacets||[],this.hierarchicalFacets=i.hierarchicalFacets||[],this.facetsRefinements=i.facetsRefinements||{},this.facetsExcludes=i.facetsExcludes||{},this.disjunctiveFacetsRefinements=i.disjunctiveFacetsRefinements||{},this.numericRefinements=i.numericRefinements||{},this.tagRefinements=i.tagRefinements||[],this.hierarchicalFacetsRefinements=i.hierarchicalFacetsRefinements||{};var a=this;Object.keys(i).forEach(function(m){var v=b.PARAMETERS.indexOf(m)!==-1,c=i[m]!==void 0;!v&&c&&(a[m]=i[m])})}return b.PARAMETERS=Object.keys(new b),b._parseNumbers=function(o){if(o instanceof b)return o;var i={},a=["aroundPrecision","aroundRadius","getRankingInfo","minWordSizefor2Typos","minWordSizefor1Typo","page","maxValuesPerFacet","distinct","minimumAroundRadius","hitsPerPage","minProximity"];if(a.forEach(function(v){var c=o[v];if(typeof c=="string"){var l=parseFloat(c);i[v]=isNaN(l)?c:l}}),Array.isArray(o.insideBoundingBox)&&(i.insideBoundingBox=o.insideBoundingBox.map(function(v){return Array.isArray(v)?v.map(function(c){return parseFloat(c)}):v})),o.numericRefinements){var m={};Object.keys(o.numericRefinements).forEach(function(v){var c=o.numericRefinements[v]||{};m[v]={},Object.keys(c).forEach(function(l){var P=c[l],x=P.map(function(j){return Array.isArray(j)?j.map(function(O){return typeof O=="string"?parseFloat(O):O}):typeof j=="string"?parseFloat(j):j});m[v][l]=x})}),i.numericRefinements=m}return r(o,i)},b.make=function(i){var a=new b(i),m=i.hierarchicalFacets||[];return m.forEach(function(v){if(v.rootPath){var c=a.getHierarchicalRefinement(v.name);c.length>0&&c[0].indexOf(v.rootPath)!==0&&(a=a.clearRefinements(v.name)),c=a.getHierarchicalRefinement(v.name),c.length===0&&(a=a.toggleHierarchicalFacetRefinement(v.name,v.rootPath))}}),a},b.validate=function(o,i){var a=i||{};return o.tagFilters&&a.tagRefinements&&a.tagRefinements.length>0?new Error("[Tags] Cannot switch from the managed tag API to the advanced API. It is probably an error, if it is really what you want, you should first clear the tags with clearTags method."):o.tagRefinements.length>0&&a.tagFilters?new Error("[Tags] Cannot switch from the advanced tag API to the managed API. It is probably an error, if it is not, you should first clear the tags with clearTags method."):o.numericFilters&&a.numericRefinements&&u(a.numericRefinements)?new Error("[Numeric filters] Can't switch from the advanced to the managed API. It is probably an error, if this is really what you want, you have to first clear the numeric filters."):u(o.numericRefinements)&&a.numericFilters?new Error("[Numeric filters] Can't switch from the managed API to the advanced. It is probably an error, if this is really what you want, you have to first clear the numeric filters."):null},b.prototype={constructor:b,clearRefinements:function(i){var a={numericRefinements:this._clearNumericRefinements(i),facetsRefinements:p.clearRefinement(this.facetsRefinements,i,"conjunctiveFacet"),facetsExcludes:p.clearRefinement(this.facetsExcludes,i,"exclude"),disjunctiveFacetsRefinements:p.clearRefinement(this.disjunctiveFacetsRefinements,i,"disjunctiveFacet"),hierarchicalFacetsRefinements:p.clearRefinement(this.hierarchicalFacetsRefinements,i,"hierarchicalFacet")};return a.numericRefinements===this.numericRefinements&&a.facetsRefinements===this.facetsRefinements&&a.facetsExcludes===this.facetsExcludes&&a.disjunctiveFacetsRefinements===this.disjunctiveFacetsRefinements&&a.hierarchicalFacetsRefinements===this.hierarchicalFacetsRefinements?this:this.setQueryParameters(a)},clearTags:function(){return this.tagFilters===void 0&&this.tagRefinements.length===0?this:this.setQueryParameters({tagFilters:void 0,tagRefinements:[]})},setIndex:function(i){return i===this.index?this:this.setQueryParameters({index:i})},setQuery:function(i){return i===this.query?this:this.setQueryParameters({query:i})},setPage:function(i){return i===this.page?this:this.setQueryParameters({page:i})},setFacets:function(i){return this.setQueryParameters({facets:i})},setDisjunctiveFacets:function(i){return this.setQueryParameters({disjunctiveFacets:i})},setHitsPerPage:function(i){return this.hitsPerPage===i?this:this.setQueryParameters({hitsPerPage:i})},setTypoTolerance:function(i){return this.typoTolerance===i?this:this.setQueryParameters({typoTolerance:i})},addNumericRefinement:function(o,i,a){var m=f(a);if(this.isNumericRefined(o,i,m))return this;var v=r({},this.numericRefinements);return v[o]=r({},v[o]),v[o][i]?(v[o][i]=v[o][i].slice(),v[o][i].push(m)):v[o][i]=[m],this.setQueryParameters({numericRefinements:v})},getConjunctiveRefinements:function(o){return this.isConjunctiveFacet(o)?this.facetsRefinements[o]||[]:[]},getDisjunctiveRefinements:function(o){return this.isDisjunctiveFacet(o)?this.disjunctiveFacetsRefinements[o]||[]:[]},getHierarchicalRefinement:function(o){return this.hierarchicalFacetsRefinements[o]||[]},getExcludeRefinements:function(o){return this.isConjunctiveFacet(o)?this.facetsExcludes[o]||[]:[]},removeNumericRefinement:function(o,i,a){var m=a;return m!==void 0?this.isNumericRefined(o,i,m)?this.setQueryParameters({numericRefinements:this._clearNumericRefinements(function(v,c){return c===o&&v.op===i&&g(v.val,f(m))})}):this:i!==void 0?this.isNumericRefined(o,i)?this.setQueryParameters({numericRefinements:this._clearNumericRefinements(function(v,c){return c===o&&v.op===i})}):this:this.isNumericRefined(o)?this.setQueryParameters({numericRefinements:this._clearNumericRefinements(function(v,c){return c===o})}):this},getNumericRefinements:function(o){return this.numericRefinements[o]||{}},getNumericRefinement:function(o,i){return this.numericRefinements[o]&&this.numericRefinements[o][i]},_clearNumericRefinements:function(i){if(i===void 0)return u(this.numericRefinements)?{}:this.numericRefinements;if(typeof i=="string")return s(this.numericRefinements,[i]);if(typeof i=="function"){var a=!1,m=this.numericRefinements,v=Object.keys(m).reduce(function(c,l){var P=m[l],x={};return P=P||{},Object.keys(P).forEach(function(j){var O=P[j]||[],E=[];O.forEach(function(d){var R=i({val:d,op:j},l,"numeric");R||E.push(d)}),E.length!==O.length&&(a=!0),x[j]=E}),c[l]=x,c},{});return a?v:this.numericRefinements}},addFacet:function(i){return this.isConjunctiveFacet(i)?this:this.setQueryParameters({facets:this.facets.concat([i])})},addDisjunctiveFacet:function(i){return this.isDisjunctiveFacet(i)?this:this.setQueryParameters({disjunctiveFacets:this.disjunctiveFacets.concat([i])})},addHierarchicalFacet:function(i){if(this.isHierarchicalFacet(i.name))throw new Error("Cannot declare two hierarchical facets with the same name: `"+i.name+"`");return this.setQueryParameters({hierarchicalFacets:this.hierarchicalFacets.concat([i])})},addFacetRefinement:function(i,a){if(!this.isConjunctiveFacet(i))throw new Error(i+" is not defined in the facets attribute of the helper configuration");return p.isRefined(this.facetsRefinements,i,a)?this:this.setQueryParameters({facetsRefinements:p.addRefinement(this.facetsRefinements,i,a)})},addExcludeRefinement:function(i,a){if(!this.isConjunctiveFacet(i))throw new Error(i+" is not defined in the facets attribute of the helper configuration");return p.isRefined(this.facetsExcludes,i,a)?this:this.setQueryParameters({facetsExcludes:p.addRefinement(this.facetsExcludes,i,a)})},addDisjunctiveFacetRefinement:function(i,a){if(!this.isDisjunctiveFacet(i))throw new Error(i+" is not defined in the disjunctiveFacets attribute of the helper configuration");return p.isRefined(this.disjunctiveFacetsRefinements,i,a)?this:this.setQueryParameters({disjunctiveFacetsRefinements:p.addRefinement(this.disjunctiveFacetsRefinements,i,a)})},addTagRefinement:function(i){if(this.isTagRefined(i))return this;var a={tagRefinements:this.tagRefinements.concat(i)};return this.setQueryParameters(a)},removeFacet:function(i){return this.isConjunctiveFacet(i)?this.clearRefinements(i).setQueryParameters({facets:this.facets.filter(function(a){return a!==i})}):this},removeDisjunctiveFacet:function(i){return this.isDisjunctiveFacet(i)?this.clearRefinements(i).setQueryParameters({disjunctiveFacets:this.disjunctiveFacets.filter(function(a){return a!==i})}):this},removeHierarchicalFacet:function(i){return this.isHierarchicalFacet(i)?this.clearRefinements(i).setQueryParameters({hierarchicalFacets:this.hierarchicalFacets.filter(function(a){return a.name!==i})}):this},removeFacetRefinement:function(i,a){if(!this.isConjunctiveFacet(i))throw new Error(i+" is not defined in the facets attribute of the helper configuration");return p.isRefined(this.facetsRefinements,i,a)?this.setQueryParameters({facetsRefinements:p.removeRefinement(this.facetsRefinements,i,a)}):this},removeExcludeRefinement:function(i,a){if(!this.isConjunctiveFacet(i))throw new Error(i+" is not defined in the facets attribute of the helper configuration");return p.isRefined(this.facetsExcludes,i,a)?this.setQueryParameters({facetsExcludes:p.removeRefinement(this.facetsExcludes,i,a)}):this},removeDisjunctiveFacetRefinement:function(i,a){if(!this.isDisjunctiveFacet(i))throw new Error(i+" is not defined in the disjunctiveFacets attribute of the helper configuration");return p.isRefined(this.disjunctiveFacetsRefinements,i,a)?this.setQueryParameters({disjunctiveFacetsRefinements:p.removeRefinement(this.disjunctiveFacetsRefinements,i,a)}):this},removeTagRefinement:function(i){if(!this.isTagRefined(i))return this;var a={tagRefinements:this.tagRefinements.filter(function(m){return m!==i})};return this.setQueryParameters(a)},toggleRefinement:function(i,a){return this.toggleFacetRefinement(i,a)},toggleFacetRefinement:function(i,a){if(this.isHierarchicalFacet(i))return this.toggleHierarchicalFacetRefinement(i,a);if(this.isConjunctiveFacet(i))return this.toggleConjunctiveFacetRefinement(i,a);if(this.isDisjunctiveFacet(i))return this.toggleDisjunctiveFacetRefinement(i,a);throw new Error("Cannot refine the undeclared facet "+i+"; it should be added to the helper options facets, disjunctiveFacets or hierarchicalFacets")},toggleConjunctiveFacetRefinement:function(i,a){if(!this.isConjunctiveFacet(i))throw new Error(i+" is not defined in the facets attribute of the helper configuration");return this.setQueryParameters({facetsRefinements:p.toggleRefinement(this.facetsRefinements,i,a)})},toggleExcludeFacetRefinement:function(i,a){if(!this.isConjunctiveFacet(i))throw new Error(i+" is not defined in the facets attribute of the helper configuration");return this.setQueryParameters({facetsExcludes:p.toggleRefinement(this.facetsExcludes,i,a)})},toggleDisjunctiveFacetRefinement:function(i,a){if(!this.isDisjunctiveFacet(i))throw new Error(i+" is not defined in the disjunctiveFacets attribute of the helper configuration");return this.setQueryParameters({disjunctiveFacetsRefinements:p.toggleRefinement(this.disjunctiveFacetsRefinements,i,a)})},toggleHierarchicalFacetRefinement:function(i,a){if(!this.isHierarchicalFacet(i))throw new Error(i+" is not defined in the hierarchicalFacets attribute of the helper configuration");var m=this._getHierarchicalFacetSeparator(this.getHierarchicalFacetByName(i)),v={},c=this.hierarchicalFacetsRefinements[i]!==void 0&&this.hierarchicalFacetsRefinements[i].length>0&&(this.hierarchicalFacetsRefinements[i][0]===a||this.hierarchicalFacetsRefinements[i][0].indexOf(a+m)===0);return c?a.indexOf(m)===-1?v[i]=[]:v[i]=[a.slice(0,a.lastIndexOf(m))]:v[i]=[a],this.setQueryParameters({hierarchicalFacetsRefinements:e({},v,this.hierarchicalFacetsRefinements)})},addHierarchicalFacetRefinement:function(o,i){if(this.isHierarchicalFacetRefined(o))throw new Error(o+" is already refined.");if(!this.isHierarchicalFacet(o))throw new Error(o+" is not defined in the hierarchicalFacets attribute of the helper configuration.");var a={};return a[o]=[i],this.setQueryParameters({hierarchicalFacetsRefinements:e({},a,this.hierarchicalFacetsRefinements)})},removeHierarchicalFacetRefinement:function(o){if(!this.isHierarchicalFacetRefined(o))return this;var i={};return i[o]=[],this.setQueryParameters({hierarchicalFacetsRefinements:e({},i,this.hierarchicalFacetsRefinements)})},toggleTagRefinement:function(i){return this.isTagRefined(i)?this.removeTagRefinement(i):this.addTagRefinement(i)},isDisjunctiveFacet:function(o){return this.disjunctiveFacets.indexOf(o)>-1},isHierarchicalFacet:function(o){return this.getHierarchicalFacetByName(o)!==void 0},isConjunctiveFacet:function(o){return this.facets.indexOf(o)>-1},isFacetRefined:function(i,a){return this.isConjunctiveFacet(i)?p.isRefined(this.facetsRefinements,i,a):!1},isExcludeRefined:function(i,a){return this.isConjunctiveFacet(i)?p.isRefined(this.facetsExcludes,i,a):!1},isDisjunctiveFacetRefined:function(i,a){return this.isDisjunctiveFacet(i)?p.isRefined(this.disjunctiveFacetsRefinements,i,a):!1},isHierarchicalFacetRefined:function(i,a){if(!this.isHierarchicalFacet(i))return!1;var m=this.getHierarchicalRefinement(i);return a?m.indexOf(a)!==-1:m.length>0},isNumericRefined:function(i,a,m){if(m===void 0&&a===void 0)return!!this.numericRefinements[i];var v=this.numericRefinements[i]&&this.numericRefinements[i][a]!==void 0;if(m===void 0||!v)return v;var c=f(m),l=y(this.numericRefinements[i][a],c)!==void 0;return v&&l},isTagRefined:function(i){return this.tagRefinements.indexOf(i)!==-1},getRefinedDisjunctiveFacets:function(){var i=this,a=n(Object.keys(this.numericRefinements).filter(function(m){return Object.keys(i.numericRefinements[m]).length>0}),this.disjunctiveFacets);return Object.keys(this.disjunctiveFacetsRefinements).filter(function(m){return i.disjunctiveFacetsRefinements[m].length>0}).concat(a).concat(this.getRefinedHierarchicalFacets()).sort()},getRefinedHierarchicalFacets:function(){var i=this;return n(this.hierarchicalFacets.map(function(a){return a.name}),Object.keys(this.hierarchicalFacetsRefinements).filter(function(a){return i.hierarchicalFacetsRefinements[a].length>0})).sort()},getUnrefinedDisjunctiveFacets:function(){var o=this.getRefinedDisjunctiveFacets();return this.disjunctiveFacets.filter(function(i){return o.indexOf(i)===-1})},managedParameters:["index","facets","disjunctiveFacets","facetsRefinements","hierarchicalFacets","facetsExcludes","disjunctiveFacetsRefinements","numericRefinements","tagRefinements","hierarchicalFacetsRefinements"],getQueryParams:function(){var i=this.managedParameters,a={},m=this;return Object.keys(this).forEach(function(v){var c=m[v];i.indexOf(v)===-1&&c!==void 0&&(a[v]=c)}),a},setQueryParameter:function(i,a){if(this[i]===a)return this;var m={};return m[i]=a,this.setQueryParameters(m)},setQueryParameters:function(i){if(!i)return this;var a=b.validate(this,i);if(a)throw a;var m=this,v=b._parseNumbers(i),c=Object.keys(this).reduce(function(P,x){return P[x]=m[x],P},{}),l=Object.keys(v).reduce(function(P,x){var j=P[x]!==void 0,O=v[x]!==void 0;return j&&!O?s(P,[x]):(O&&(P[x]=v[x]),P)},c);return new this.constructor(l)},resetPage:function(){return this.page===void 0?this:this.setPage(0)},_getHierarchicalFacetSortBy:function(o){return o.sortBy||["isRefined:desc","name:asc"]},_getHierarchicalFacetSeparator:function(o){return o.separator||" > "},_getHierarchicalRootPath:function(o){return o.rootPath||null},_getHierarchicalShowParentLevel:function(o){return typeof o.showParentLevel=="boolean"?o.showParentLevel:!0},getHierarchicalFacetByName:function(o){return t(this.hierarchicalFacets,function(i){return i.name===o})},getHierarchicalFacetBreadcrumb:function(o){if(!this.isHierarchicalFacet(o))return[];var i=this.getHierarchicalRefinement(o)[0];if(!i)return[];var a=this._getHierarchicalFacetSeparator(this.getHierarchicalFacetByName(o)),m=i.split(a);return m.map(function(v){return v.trim()})},toString:function(){return JSON.stringify(this,null,2)}},be=b,be}var xe,gt;function Lr(){return gt||(gt=1,xe=function(t){return Array.isArray(t)?t.filter(Boolean):[]}),xe}var Ee,pt;function Ur(){return pt||(pt=1,Ee=function(t,n){if(!Array.isArray(t))return-1;for(var r=0;r<t.length;r++)if(n(t[r]))return r;return-1}),Ee}var Oe,Rt;function Nt(){if(Rt)return Oe;Rt=1;var e=re();return Oe=function(n,r){var u=(r||[]).map(function(s){return s.split(":")});return n.reduce(function(f,h){var p=h.split(":"),g=e(u,function(y){return y[0]===p[0]});return p.length>1||!g?(f[0].push(p[0]),f[1].push(p[1]),f):(f[0].push(g[0]),f[1].push(g[1]),f)},[[],[]])},Oe}var He,yt;function qt(){if(yt)return He;yt=1;function e(n,r){if(n!==r){var u=n!==void 0,s=n===null,f=r!==void 0,h=r===null;if(!h&&n>r||s&&f||!u)return 1;if(!s&&n<r||h&&u||!f)return-1}return 0}function t(n,r,u){if(!Array.isArray(n))return[];Array.isArray(u)||(u=[]);var s=n.map(function(f,h){return{criteria:r.map(function(p){return f[p]}),index:h,value:f}});return s.sort(function(h,p){for(var g=-1;++g<h.criteria.length;){var y=e(h.criteria[g],p.criteria[g]);if(y)return g>=u.length?y:u[g]==="desc"?-y:y}return h.index-p.index}),s.map(function(f){return f.value})}return He=t,He}var we,Ft;function Vr(){if(Ft)return we;Ft=1,we=f;var e=Ue(),t=re(),n=Nt(),r=qt(),u=e.escapeFacetValue,s=e.unescapeFacetValue;function f(y){return function(o,i){var a=y.hierarchicalFacets[i],m=y.hierarchicalFacetsRefinements[a.name]&&y.hierarchicalFacetsRefinements[a.name][0]||"",v=y._getHierarchicalFacetSeparator(a),c=y._getHierarchicalRootPath(a),l=y._getHierarchicalShowParentLevel(a),P=n(y._getHierarchicalFacetSortBy(a)),x=o.every(function(E){return E.exhaustive}),j=h(P,v,c,l,m),O=o;return c&&(O=o.slice(c.split(v).length)),O.reduce(j,{name:y.hierarchicalFacets[i].name,count:null,isRefined:!0,path:null,escapedValue:null,exhaustive:x,data:null})}}function h(y,b,o,i,a){return function(v,c,l){var P=v;if(l>0){var x=0;for(P=v;x<l;){var j=P&&Array.isArray(P.data)?P.data:[];P=t(j,function(E){return E.isRefined}),x++}}if(P){var O=Object.keys(c.data).map(function(E){return[E,c.data[E]]}).filter(function(E){var d=E[0];return p(d,P.path||o,a,b,o,i)});P.data=r(O.map(function(E){var d=E[0],R=E[1];return g(R,d,b,s(a),c.exhaustive)}),y[0],y[1])}return v}}function p(y,b,o,i,a,m){return a&&(y.indexOf(a)!==0||a===y)?!1:!a&&y.indexOf(i)===-1||a&&y.split(i).length-a.split(i).length===1||y.indexOf(i)===-1&&o.indexOf(i)===-1||o.indexOf(y)===0||y.indexOf(b+i)===0&&(m||y.indexOf(o)===0)}function g(y,b,o,i,a){var m=b.split(o);return{name:m[m.length-1].trim(),path:b,escapedValue:u(b),count:y,isRefined:i===b||i.indexOf(b+o)===0,exhaustive:a,data:null}}return we}var Ae,Pt;function Wt(){if(Pt)return Ae;Pt=1;var e=Lr(),t=Me(),n=Ue(),r=re(),u=Ur(),s=Nt(),f=ce(),h=qt(),p=n.escapeFacetValue,g=n.unescapeFacetValue,y=Vr();function b(d){var R={};return d.forEach(function(_,F){R[_]=F}),R}function o(d,R,_){R&&R[_]&&(d.stats=R[_])}function i(d,R){return r(d,function(F){var S=F.attributes||[];return S.indexOf(R)>-1})}function a(d,R,_){var F=R[0]||{};this._rawResults=R;var S=this;Object.keys(F).forEach(function(H){S[H]=F[H]});var w=f({persistHierarchicalRootCount:!1},_);Object.keys(w).forEach(function(H){S[H]=w[H]}),this.processingTimeMS=R.reduce(function(H,I){return I.processingTimeMS===void 0?H:H+I.processingTimeMS},0),this.disjunctiveFacets=[],this.hierarchicalFacets=d.hierarchicalFacets.map(function(){return[]}),this.facets=[];var A=d.getRefinedDisjunctiveFacets(),C=b(d.facets),Q=b(d.disjunctiveFacets),D=1,T=F.facets||{};Object.keys(T).forEach(function(H){var I=T[H],N=i(d.hierarchicalFacets,H);if(N){var W=N.attributes.indexOf(H),q=u(d.hierarchicalFacets,function(z){return z.name===N.name});S.hierarchicalFacets[q][W]={attribute:H,data:I,exhaustive:F.exhaustiveFacetsCount}}else{var J=d.disjunctiveFacets.indexOf(H)!==-1,B=d.facets.indexOf(H)!==-1,L;J&&(L=Q[H],S.disjunctiveFacets[L]={name:H,data:I,exhaustive:F.exhaustiveFacetsCount},o(S.disjunctiveFacets[L],F.facets_stats,H)),B&&(L=C[H],S.facets[L]={name:H,data:I,exhaustive:F.exhaustiveFacetsCount},o(S.facets[L],F.facets_stats,H))}}),this.hierarchicalFacets=e(this.hierarchicalFacets),A.forEach(function(H){var I=R[D],N=I&&I.facets?I.facets:{},W=d.getHierarchicalFacetByName(H);Object.keys(N).forEach(function(q){var J=N[q],B;if(W){B=u(d.hierarchicalFacets,function(U){return U.name===W.name});var L=u(S.hierarchicalFacets[B],function(U){return U.attribute===q});if(L===-1)return;S.hierarchicalFacets[B][L].data=f({},S.hierarchicalFacets[B][L].data,J)}else{B=Q[q];var z=F.facets&&F.facets[q]||{};S.disjunctiveFacets[B]={name:q,data:t({},J,z),exhaustive:I.exhaustiveFacetsCount},o(S.disjunctiveFacets[B],I.facets_stats,q),d.disjunctiveFacetsRefinements[q]&&d.disjunctiveFacetsRefinements[q].forEach(function(U){!S.disjunctiveFacets[B].data[U]&&d.disjunctiveFacetsRefinements[q].indexOf(g(U))>-1&&(S.disjunctiveFacets[B].data[U]=0)})}}),D++}),d.getRefinedHierarchicalFacets().forEach(function(H){var I=d.getHierarchicalFacetByName(H),N=d._getHierarchicalFacetSeparator(I),W=d.getHierarchicalRefinement(H);W.length===0||W[0].split(N).length<2||R.slice(D).forEach(function(q){var J=q&&q.facets?q.facets:{};Object.keys(J).forEach(function(B){var L=J[B],z=u(d.hierarchicalFacets,function(ue){return ue.name===I.name}),U=u(S.hierarchicalFacets[z],function(ue){return ue.attribute===B});if(U!==-1){var ke={};if(W.length>0&&!S.persistHierarchicalRootCount){var ze=W[0].split(N)[0];ke[ze]=S.hierarchicalFacets[z][U].data[ze]}S.hierarchicalFacets[z][U].data=t(ke,L,S.hierarchicalFacets[z][U].data)}}),D++})}),Object.keys(d.facetsExcludes).forEach(function(H){var I=d.facetsExcludes[H],N=C[H];S.facets[N]={name:H,data:T[H],exhaustive:F.exhaustiveFacetsCount},I.forEach(function(W){S.facets[N]=S.facets[N]||{name:H},S.facets[N].data=S.facets[N].data||{},S.facets[N].data[W]=0})}),this.hierarchicalFacets=this.hierarchicalFacets.map(y(d)),this.facets=e(this.facets),this.disjunctiveFacets=e(this.disjunctiveFacets),this._state=d}a.prototype.getFacetByName=function(d){function R(_){return _.name===d}return r(this.facets,R)||r(this.disjunctiveFacets,R)||r(this.hierarchicalFacets,R)};function m(d,R){function _(T){return T.name===R}if(d._state.isConjunctiveFacet(R)){var F=r(d.facets,_);return F?Object.keys(F.data).map(function(T){var H=p(T);return{name:T,escapedValue:H,count:F.data[T],isRefined:d._state.isFacetRefined(R,H),isExcluded:d._state.isExcludeRefined(R,T)}}):[]}else if(d._state.isDisjunctiveFacet(R)){var S=r(d.disjunctiveFacets,_);return S?Object.keys(S.data).map(function(T){var H=p(T);return{name:T,escapedValue:H,count:S.data[T],isRefined:d._state.isDisjunctiveFacetRefined(R,H)}}):[]}else if(d._state.isHierarchicalFacet(R)){var w=r(d.hierarchicalFacets,_);if(!w)return w;var A=d._state.getHierarchicalFacetByName(R),C=d._state._getHierarchicalFacetSeparator(A),Q=g(d._state.getHierarchicalRefinement(R)[0]||"");Q.indexOf(A.rootPath)===0&&(Q=Q.replace(A.rootPath+C,""));var D=Q.split(C);return D.unshift(R),v(w,D,0),w}}function v(d,R,_){d.isRefined=d.name===(R[_]&&R[_].trim()),d.data&&d.data.forEach(function(F){v(F,R,_+1)})}function c(d,R,_,F){if(F=F||0,Array.isArray(R))return d(R,_[F]);if(!R.data||R.data.length===0)return R;var S=R.data.map(function(C){return c(d,C,_,F+1)}),w=d(S,_[F]),A=t({data:w},R);return A}a.DEFAULT_SORT=["isRefined:desc","count:desc","name:asc"];function l(d,R){return R.sort(d)}function P(d,R){var _=[],F=[],S=R.hide||[],w=R.order||[],A=w.reduce(function(D,T,H){return D[T]=H,D},{});d.forEach(function(D){var T=D.path||D.name,H=S.indexOf(T)>-1;!H&&A[T]!==void 0?_[A[T]]=D:H||F.push(D)}),_=_.filter(function(D){return D});var C=R.sortRemainingBy,Q;return C==="hidden"?_:(C==="alpha"?Q=[["path","name"],["asc","asc"]]:Q=[["count"],["desc"]],_.concat(h(F,Q[0],Q[1])))}function x(d,R){return d.renderingContent&&d.renderingContent.facetOrdering&&d.renderingContent.facetOrdering.values&&d.renderingContent.facetOrdering.values[R]}a.prototype.getFacetValues=function(d,R){var _=m(this,d);if(_){var F=t({},R,{sortBy:a.DEFAULT_SORT,facetOrdering:!(R&&R.sortBy)}),S=this,w;if(Array.isArray(_))w=[d];else{var A=S._state.getHierarchicalFacetByName(_.name);w=A.attributes}return c(function(C,Q){if(F.facetOrdering){var D=x(S,Q);if(D)return P(C,D)}if(Array.isArray(F.sortBy)){var T=s(F.sortBy,a.DEFAULT_SORT);return h(C,T[0],T[1])}else if(typeof F.sortBy=="function")return l(F.sortBy,C);throw new Error("options.sortBy is optional but if defined it must be either an array of string (predicates) or a sorting function")},_,w)}},a.prototype.getFacetStats=function(d){if(this._state.isConjunctiveFacet(d))return j(this.facets,d);if(this._state.isDisjunctiveFacet(d))return j(this.disjunctiveFacets,d)};function j(d,R){var _=r(d,function(F){return F.name===R});return _&&_.stats}a.prototype.getRefinements=function(){var d=this._state,R=this,_=[];return Object.keys(d.facetsRefinements).forEach(function(F){d.facetsRefinements[F].forEach(function(S){_.push(O(d,"facet",F,S,R.facets))})}),Object.keys(d.facetsExcludes).forEach(function(F){d.facetsExcludes[F].forEach(function(S){_.push(O(d,"exclude",F,S,R.facets))})}),Object.keys(d.disjunctiveFacetsRefinements).forEach(function(F){d.disjunctiveFacetsRefinements[F].forEach(function(S){_.push(O(d,"disjunctive",F,S,R.disjunctiveFacets))})}),Object.keys(d.hierarchicalFacetsRefinements).forEach(function(F){d.hierarchicalFacetsRefinements[F].forEach(function(S){_.push(E(d,F,S,R.hierarchicalFacets))})}),Object.keys(d.numericRefinements).forEach(function(F){var S=d.numericRefinements[F];Object.keys(S).forEach(function(w){S[w].forEach(function(A){_.push({type:"numeric",attributeName:F,name:A,numericValue:A,operator:w})})})}),d.tagRefinements.forEach(function(F){_.push({type:"tag",attributeName:"_tags",name:F})}),_};function O(d,R,_,F,S){var w=r(S,function(Q){return Q.name===_}),A=w&&w.data&&w.data[F]?w.data[F]:0,C=w&&w.exhaustive||!1;return{type:R,attributeName:_,name:F,count:A,exhaustive:C}}function E(d,R,_,F){var S=d.getHierarchicalFacetByName(R),w=d._getHierarchicalFacetSeparator(S),A=_.split(w),C=r(F,function(I){return I.name===R}),Q=A.reduce(function(I,N){var W=I&&r(I.data,function(q){return q.name===N});return W!==void 0?W:I},C),D=Q&&Q.count||0,T=Q&&Q.exhaustive||!1,H=Q&&Q.path||"";return{type:"hierarchical",attributeName:R,name:H,count:D,exhaustive:T}}return Ae=a,Ae}var Te,_t;function $r(){return _t||(_t=1,Te=function(t){return t.reduce(function(n,r){return n.concat(r)},[])}),Te}var Qe,jt;function Mr(){if(jt)return Qe;jt=1;var e=re(),t=$r();function n(u,s){var f=[];return Object.keys(u).forEach(function(h){u[h].count<2&&(u[h].indexSum+=100),f.push({objectID:h,avgOfIndices:u[h].indexSum/s})}),f.sort(function(h,p){return h.avgOfIndices>p.avgOfIndices?1:-1})}function r(u){var s={};u.forEach(function(p){p.forEach(function(g,y){s[g.objectID]?s[g.objectID]={indexSum:s[g.objectID].indexSum+y,count:s[g.objectID].count+1}:s[g.objectID]={indexSum:y,count:1}})});var f=n(s,u.length),h=f.reduce(function(p,g){var y=e(t(u),function(b){return b.objectID===g.objectID});return y?p.concat(y):p},[]);return h}return Qe=r,Qe}var Ie,St;function Bt(){return St||(St=1,Ie="3.22.5"),Ie}var De,bt;function kr(){if(bt)return De;bt=1;var e=Tt(),t=Dr(),n=Ue().escapeFacetValue,r=Qt(),u=ce(),s=Ve(),f=$e(),h=It(),p=Dt(),g=Cr(),y=Ct(),b=Wt(),o=Mr(),i=Bt();function a(c,l,P,x){typeof c.addAlgoliaAgent=="function"&&c.addAlgoliaAgent("JS Helper ("+i+")"),this.setClient(c);var j=P||{};j.index=l,this.state=y.make(j),this.recommendState=new h({params:j.recommendState}),this.lastResults=null,this.lastRecommendResults=null,this._queryId=0,this._recommendQueryId=0,this._lastQueryIdReceived=-1,this._lastRecommendQueryIdReceived=-1,this.derivedHelpers=[],this._currentNbQueries=0,this._currentNbRecommendQueries=0,this._searchResultsOptions=x,this._recommendCache={}}r(a,e),a.prototype.search=function(){return this._search({onlyWithDerivedHelpers:!1}),this},a.prototype.searchOnlyWithDerivedHelpers=function(){return this._search({onlyWithDerivedHelpers:!0}),this},a.prototype.recommend=function(){return this._recommend(),this},a.prototype.getQuery=function(){var c=this.state;return g._getHitsSearchParams(c)},a.prototype.searchOnce=function(c,l){var P=c?this.state.setQueryParameters(c):this.state,x=g._getQueries(P.index,P),j=this;if(this._currentNbQueries++,this.emit("searchOnce",{state:P}),l){this.client.search(x).then(function(O){j._currentNbQueries--,j._currentNbQueries===0&&j.emit("searchQueueEmpty"),l(null,new b(P,O.results),P)}).catch(function(O){j._currentNbQueries--,j._currentNbQueries===0&&j.emit("searchQueueEmpty"),l(O,null,P)});return}return this.client.search(x).then(function(O){return j._currentNbQueries--,j._currentNbQueries===0&&j.emit("searchQueueEmpty"),{content:new b(P,O.results),state:P,_originalResponse:O}},function(O){throw j._currentNbQueries--,j._currentNbQueries===0&&j.emit("searchQueueEmpty"),O})},a.prototype.findAnswers=function(c){console.warn("[algoliasearch-helper] answers is no longer supported");var l=this.state,P=this.derivedHelpers[0];if(!P)return Promise.resolve([]);var x=P.getModifiedState(l),j=u({attributesForPrediction:c.attributesForPrediction,nbHits:c.nbHits},{params:f(g._getHitsSearchParams(x),["attributesToSnippet","hitsPerPage","restrictSearchableAttributes","snippetEllipsisText"])}),O="search for answers was called, but this client does not have a function client.initIndex(index).findAnswers";if(typeof this.client.initIndex!="function")throw new Error(O);var E=this.client.initIndex(x.index);if(typeof E.findAnswers!="function")throw new Error(O);return E.findAnswers(x.query,c.queryLanguages,j)},a.prototype.searchForFacetValues=function(c,l,P,x){var j=typeof this.client.searchForFacetValues=="function"&&typeof this.client.searchForFacets!="function",O=typeof this.client.initIndex=="function";if(!j&&!O&&typeof this.client.search!="function")throw new Error("search for facet values (searchable) was called, but this client does not have a function client.searchForFacetValues or client.initIndex(index).searchForFacetValues");var E=this.state.setQueryParameters(x||{}),d=E.isDisjunctiveFacet(c),R=g.getSearchForFacetQuery(c,l,P,E);this._currentNbQueries++;var _=this,F;return j?F=this.client.searchForFacetValues([{indexName:E.index,params:R}]):O?F=this.client.initIndex(E.index).searchForFacetValues(R):(delete R.facetName,F=this.client.search([{type:"facet",facet:c,indexName:E.index,params:R}]).then(function(w){return w.results[0]})),this.emit("searchForFacetValues",{state:E,facet:c,query:l}),F.then(function(w){return _._currentNbQueries--,_._currentNbQueries===0&&_.emit("searchQueueEmpty"),w=Array.isArray(w)?w[0]:w,w.facetHits.forEach(function(A){A.escapedValue=n(A.value),A.isRefined=d?E.isDisjunctiveFacetRefined(c,A.escapedValue):E.isFacetRefined(c,A.escapedValue)}),w},function(S){throw _._currentNbQueries--,_._currentNbQueries===0&&_.emit("searchQueueEmpty"),S})},a.prototype.setQuery=function(c){return this._change({state:this.state.resetPage().setQuery(c),isPageReset:!0}),this},a.prototype.clearRefinements=function(c){return this._change({state:this.state.resetPage().clearRefinements(c),isPageReset:!0}),this},a.prototype.clearTags=function(){return this._change({state:this.state.resetPage().clearTags(),isPageReset:!0}),this},a.prototype.addDisjunctiveFacetRefinement=function(c,l){return this._change({state:this.state.resetPage().addDisjunctiveFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.addDisjunctiveRefine=function(){return this.addDisjunctiveFacetRefinement.apply(this,arguments)},a.prototype.addHierarchicalFacetRefinement=function(c,l){return this._change({state:this.state.resetPage().addHierarchicalFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.addNumericRefinement=function(c,l,P){return this._change({state:this.state.resetPage().addNumericRefinement(c,l,P),isPageReset:!0}),this},a.prototype.addFacetRefinement=function(c,l){return this._change({state:this.state.resetPage().addFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.addRefine=function(){return this.addFacetRefinement.apply(this,arguments)},a.prototype.addFacetExclusion=function(c,l){return this._change({state:this.state.resetPage().addExcludeRefinement(c,l),isPageReset:!0}),this},a.prototype.addExclude=function(){return this.addFacetExclusion.apply(this,arguments)},a.prototype.addTag=function(c){return this._change({state:this.state.resetPage().addTagRefinement(c),isPageReset:!0}),this},a.prototype.addFrequentlyBoughtTogether=function(c){return this._recommendChange({state:this.recommendState.addFrequentlyBoughtTogether(c)}),this},a.prototype.addRelatedProducts=function(c){return this._recommendChange({state:this.recommendState.addRelatedProducts(c)}),this},a.prototype.addTrendingItems=function(c){return this._recommendChange({state:this.recommendState.addTrendingItems(c)}),this},a.prototype.addTrendingFacets=function(c){return this._recommendChange({state:this.recommendState.addTrendingFacets(c)}),this},a.prototype.addLookingSimilar=function(c){return this._recommendChange({state:this.recommendState.addLookingSimilar(c)}),this},a.prototype.removeNumericRefinement=function(c,l,P){return this._change({state:this.state.resetPage().removeNumericRefinement(c,l,P),isPageReset:!0}),this},a.prototype.removeDisjunctiveFacetRefinement=function(c,l){return this._change({state:this.state.resetPage().removeDisjunctiveFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.removeDisjunctiveRefine=function(){return this.removeDisjunctiveFacetRefinement.apply(this,arguments)},a.prototype.removeHierarchicalFacetRefinement=function(c){return this._change({state:this.state.resetPage().removeHierarchicalFacetRefinement(c),isPageReset:!0}),this},a.prototype.removeFacetRefinement=function(c,l){return this._change({state:this.state.resetPage().removeFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.removeRefine=function(){return this.removeFacetRefinement.apply(this,arguments)},a.prototype.removeFacetExclusion=function(c,l){return this._change({state:this.state.resetPage().removeExcludeRefinement(c,l),isPageReset:!0}),this},a.prototype.removeExclude=function(){return this.removeFacetExclusion.apply(this,arguments)},a.prototype.removeTag=function(c){return this._change({state:this.state.resetPage().removeTagRefinement(c),isPageReset:!0}),this},a.prototype.removeFrequentlyBoughtTogether=function(c){return this._recommendChange({state:this.recommendState.removeParams(c)}),this},a.prototype.removeRelatedProducts=function(c){return this._recommendChange({state:this.recommendState.removeParams(c)}),this},a.prototype.removeTrendingItems=function(c){return this._recommendChange({state:this.recommendState.removeParams(c)}),this},a.prototype.removeTrendingFacets=function(c){return this._recommendChange({state:this.recommendState.removeParams(c)}),this},a.prototype.removeLookingSimilar=function(c){return this._recommendChange({state:this.recommendState.removeParams(c)}),this},a.prototype.toggleFacetExclusion=function(c,l){return this._change({state:this.state.resetPage().toggleExcludeFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.toggleExclude=function(){return this.toggleFacetExclusion.apply(this,arguments)},a.prototype.toggleRefinement=function(c,l){return this.toggleFacetRefinement(c,l)},a.prototype.toggleFacetRefinement=function(c,l){return this._change({state:this.state.resetPage().toggleFacetRefinement(c,l),isPageReset:!0}),this},a.prototype.toggleRefine=function(){return this.toggleFacetRefinement.apply(this,arguments)},a.prototype.toggleTag=function(c){return this._change({state:this.state.resetPage().toggleTagRefinement(c),isPageReset:!0}),this},a.prototype.nextPage=function(){var c=this.state.page||0;return this.setPage(c+1)},a.prototype.previousPage=function(){var c=this.state.page||0;return this.setPage(c-1)};function m(c){if(c<0)throw new Error("Page requested below 0.");return this._change({state:this.state.setPage(c),isPageReset:!1}),this}a.prototype.setCurrentPage=m,a.prototype.setPage=m,a.prototype.setIndex=function(c){return this._change({state:this.state.resetPage().setIndex(c),isPageReset:!0}),this},a.prototype.setQueryParameter=function(c,l){return this._change({state:this.state.resetPage().setQueryParameter(c,l),isPageReset:!0}),this},a.prototype.setState=function(c){return this._change({state:y.make(c),isPageReset:!1}),this},a.prototype.overrideStateWithoutTriggeringChangeEvent=function(c){return this.state=new y(c),this},a.prototype.hasRefinements=function(c){return s(this.state.getNumericRefinements(c))?!0:this.state.isConjunctiveFacet(c)?this.state.isFacetRefined(c):this.state.isDisjunctiveFacet(c)?this.state.isDisjunctiveFacetRefined(c):this.state.isHierarchicalFacet(c)?this.state.isHierarchicalFacetRefined(c):!1},a.prototype.isExcluded=function(c,l){return this.state.isExcludeRefined(c,l)},a.prototype.isDisjunctiveRefined=function(c,l){return this.state.isDisjunctiveFacetRefined(c,l)},a.prototype.hasTag=function(c){return this.state.isTagRefined(c)},a.prototype.isTagRefined=function(){return this.hasTagRefinements.apply(this,arguments)},a.prototype.getIndex=function(){return this.state.index};function v(){return this.state.page}return a.prototype.getCurrentPage=v,a.prototype.getPage=v,a.prototype.getTags=function(){return this.state.tagRefinements},a.prototype.getRefinements=function(c){var l=[];if(this.state.isConjunctiveFacet(c)){var P=this.state.getConjunctiveRefinements(c);P.forEach(function(E){l.push({value:E,type:"conjunctive"})});var x=this.state.getExcludeRefinements(c);x.forEach(function(E){l.push({value:E,type:"exclude"})})}else if(this.state.isDisjunctiveFacet(c)){var j=this.state.getDisjunctiveRefinements(c);j.forEach(function(E){l.push({value:E,type:"disjunctive"})})}var O=this.state.getNumericRefinements(c);return Object.keys(O).forEach(function(E){var d=O[E];l.push({value:d,operator:E,type:"numeric"})}),l},a.prototype.getNumericRefinement=function(c,l){return this.state.getNumericRefinement(c,l)},a.prototype.getHierarchicalFacetBreadcrumb=function(c){return this.state.getHierarchicalFacetBreadcrumb(c)},a.prototype._search=function(c){var l=this.state,P=[],x=[];c.onlyWithDerivedHelpers||(x=g._getQueries(l.index,l),P.push({state:l,queriesCount:x.length,helper:this}),this.emit("search",{state:l,results:this.lastResults}));var j=this.derivedHelpers.map(function(d){var R=d.getModifiedState(l),_=R.index?g._getQueries(R.index,R):[];return P.push({state:R,queriesCount:_.length,helper:d}),d.emit("search",{state:R,results:d.lastResults}),_}),O=Array.prototype.concat.apply(x,j),E=this._queryId++;if(this._currentNbQueries++,!O.length)return Promise.resolve({results:[]}).then(this._dispatchAlgoliaResponse.bind(this,P,E));try{this.client.search(O).then(this._dispatchAlgoliaResponse.bind(this,P,E)).catch(this._dispatchAlgoliaError.bind(this,E))}catch(d){this.emit("error",{error:d})}},a.prototype._recommend=function(){var c=this.state,l=this.recommendState,P=this.getIndex(),x=[{state:l,index:P,helper:this}],j=l.params.map(function(_){return _.$$id});this.emit("fetch",{recommend:{state:l,results:this.lastRecommendResults}});var O=this._recommendCache,E=this.derivedHelpers.map(function(_){var F=_.getModifiedState(c).index;if(!F)return[];var S=_.getModifiedRecommendState(new h);return x.push({state:S,index:F,helper:_}),j=Array.prototype.concat.apply(j,S.params.map(function(w){return w.$$id})),_.emit("fetch",{recommend:{state:S,results:_.lastRecommendResults}}),S._buildQueries(F,O)}),d=Array.prototype.concat.apply(this.recommendState._buildQueries(P,O),E);if(d.length!==0){if(d.length>0&&typeof this.client.getRecommendations>"u"){console.warn("Please update algoliasearch/lite to the latest version in order to use recommend widgets.");return}var R=this._recommendQueryId++;this._currentNbRecommendQueries++;try{this.client.getRecommendations(d).then(this._dispatchRecommendResponse.bind(this,R,x,j)).catch(this._dispatchRecommendError.bind(this,R))}catch(_){this.emit("error",{error:_})}}},a.prototype._dispatchAlgoliaResponse=function(c,l,P){var x=this;if(!(l<this._lastQueryIdReceived)){this._currentNbQueries-=l-this._lastQueryIdReceived,this._lastQueryIdReceived=l,this._currentNbQueries===0&&this.emit("searchQueueEmpty");var j=P.results.slice();c.forEach(function(O){var E=O.state,d=O.queriesCount,R=O.helper,_=j.splice(0,d);if(!E.index){R.emit("result",{results:null,state:E});return}R.lastResults=new b(E,_,x._searchResultsOptions),R.emit("result",{results:R.lastResults,state:E})})}},a.prototype._dispatchRecommendResponse=function(c,l,P,x){if(!(c<this._lastRecommendQueryIdReceived)){this._currentNbRecommendQueries-=c-this._lastRecommendQueryIdReceived,this._lastRecommendQueryIdReceived=c,this._currentNbRecommendQueries===0&&this.emit("recommendQueueEmpty");var j=this._recommendCache,O={};P.filter(function(d){return j[d]===void 0}).forEach(function(d,R){O[d]||(O[d]=[]),O[d].push(R)}),Object.keys(O).forEach(function(d){var R=O[d],_=x.results[R[0]];if(R.length===1){j[d]=_;return}j[d]=Object.assign({},_,{hits:o(R.map(function(F){return x.results[F].hits}))})});var E={};P.forEach(function(d){E[d]=j[d]}),l.forEach(function(d){var R=d.state,_=d.helper;if(!d.index){_.emit("recommend:result",{results:null,state:R});return}_.lastRecommendResults=new p(R,E),_.emit("recommend:result",{recommend:{results:_.lastRecommendResults,state:R}})})}},a.prototype._dispatchAlgoliaError=function(c,l){c<this._lastQueryIdReceived||(this._currentNbQueries-=c-this._lastQueryIdReceived,this._lastQueryIdReceived=c,this.emit("error",{error:l}),this._currentNbQueries===0&&this.emit("searchQueueEmpty"))},a.prototype._dispatchRecommendError=function(c,l){c<this._lastRecommendQueryIdReceived||(this._currentNbRecommendQueries-=c-this._lastRecommendQueryIdReceived,this._lastRecommendQueryIdReceived=c,this.emit("error",{error:l}),this._currentNbRecommendQueries===0&&this.emit("recommendQueueEmpty"))},a.prototype.containsRefinement=function(c,l,P,x){return c||l.length!==0||P.length!==0||x.length!==0},a.prototype._hasDisjunctiveRefinements=function(c){return this.state.disjunctiveRefinements[c]&&this.state.disjunctiveRefinements[c].length>0},a.prototype._change=function(c){var l=c.state,P=c.isPageReset;l!==this.state&&(this.state=l,this.emit("change",{state:this.state,results:this.lastResults,isPageReset:P}))},a.prototype._recommendChange=function(c){var l=c.state;l!==this.recommendState&&(this.recommendState=l,this.emit("recommend:change",{search:{results:this.lastResults,state:this.state},recommend:{results:this.lastRecommendResults,state:this.recommendState}}))},a.prototype.clearCache=function(){return this.client.clearCache&&this.client.clearCache(),this},a.prototype.setClient=function(c){return this.client===c?this:(typeof c.addAlgoliaAgent=="function"&&c.addAlgoliaAgent("JS Helper ("+i+")"),this.client=c,this)},a.prototype.getClient=function(){return this.client},a.prototype.derive=function(c,l){var P=new t(this,c,l);return this.derivedHelpers.push(P),P},a.prototype.detachDerivedHelper=function(c){var l=this.derivedHelpers.indexOf(c);if(l===-1)throw new Error("Derived helper already detached");this.derivedHelpers.splice(l,1)},a.prototype.hasPendingRequests=function(){return this._currentNbQueries>0},De=a,De}var Ce,xt;function zr(){if(xt)return Ce;xt=1;var e=kr(),t=It(),n=Dt(),r=Ct(),u=Wt();function s(f,h,p,g){return new e(f,h,p,g)}return s.version=Bt(),s.AlgoliaSearchHelper=e,s.SearchParameters=r,s.RecommendParameters=t,s.SearchResults=u,s.RecommendResults=n,Ce=s,Ce}var Jr=zr();const k=kt(Jr);function te(e){"@babel/helpers - typeof";return te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(e)}var Kr=["initialSearchParameters"],Gr=["initialRecommendParameters"];function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Et(Object(n),!0).forEach(function(r){K(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function K(e,t,n){return t=Zr(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zr(e){var t=Xr(e,"string");return te(t)==="symbol"?t:String(t)}function Xr(e,t){if(te(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(te(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lt(e){return rn(e)||tn(e)||en(e)||Yr()}function Yr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function en(e,t){if(e){if(typeof e=="string")return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}}function tn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rn(e){if(Array.isArray(e))return Le(e)}function Le(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e,t){if(e==null)return{};var n=nn(e,t),r,u;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(u=0;u<s.length;u++)r=s[u],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nn(e,t){if(e==null)return{};var n={},r=Object.keys(e),u,s;for(s=0;s<r.length;s++)u=r[s],!(t.indexOf(u)>=0)&&(n[u]=e[u]);return n}var G=hr({name:"index-widget"});function Vt(e,t){var n=t.state,r=t.recommendState,u=t.isPageReset,s=t._uiState;n!==e.state&&(e.state=n,e.emit("change",{state:e.state,results:e.lastResults,isPageReset:u,_uiState:s})),r!==e.recommendState&&(e.recommendState=r)}function Z(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e.reduce(function(r,u){return $(u)||!u.getWidgetUiState&&!u.getWidgetState?r:u.getWidgetUiState?u.getWidgetUiState(r,t):u.getWidgetState(r,t)},n)}function X(e,t){var n=t.initialSearchParameters,r=Ut(t,Kr);return e.reduce(function(u,s){return!s.getWidgetSearchParameters||$(s)?u:s.dependsOn==="search"&&s.getWidgetParameters?s.getWidgetParameters(u,r):s.getWidgetSearchParameters(u,r)},n)}function Ot(e,t){var n=t.initialRecommendParameters,r=Ut(t,Gr);return e.reduce(function(u,s){return!$(s)&&s.dependsOn==="recommend"&&s.getWidgetParameters?s.getWidgetParameters(u,r):u},n)}function $t(e){var t=e.filter($);t.length!==0&&t.forEach(function(n){var r=n.getHelper();Vt(r,{state:r.state.resetPage(),recommendState:r.recommendState,isPageReset:!0}),$t(n.getWidgets())})}function Mt(e){var t=e.filter($);return t.reduce(function(n,r){return n.concat.apply(n,[{indexId:r.getIndexId(),results:r.getResults(),helper:r.getHelper()}].concat(Lt(Mt(r.getWidgets()))))},[])}var vn=function(t){if(t===void 0||t.indexName===void 0)throw new Error(G("The `indexName` option is required."));var n=t.indexName,r=t.indexId,u=r===void 0?n:r,s=[],f={},h=null,p=null,g=null,y=null,b=null,o=!1,i=!1;return{$$type:"ais.index",$$widgetType:"ais.index",getIndexName:function(){return n},getIndexId:function(){return u},getHelper:function(){return g},getResults:function(){var m;return(m=y)!==null&&m!==void 0&&m.lastResults?(y.lastResults._state=g.state,y.lastResults):null},getResultsForWidget:function(m){var v;return m.dependsOn!=="recommend"||$(m)||m.$$id===void 0?this.getResults():(v=g)!==null&&v!==void 0&&v.lastRecommendResults?g.lastRecommendResults[m.$$id]:null},getPreviousState:function(){return b},getScopedResults:function(){var m=this.getParent(),v;return m?v=m.getWidgets():n.length===0?v=this.getWidgets():v=[this],Mt(v)},getParent:function(){return p},createURL:function(m){return typeof m=="function"?h._createURL(K({},u,m(f))):h._createURL(K({},u,Z(s,{searchParameters:m,helper:g})))},getWidgets:function(){return s},addWidgets:function(m){var v=this;if(!Array.isArray(m))throw new Error(G("The `addWidgets` method expects an array of widgets."));if(m.some(function(c){return typeof c.init!="function"&&typeof c.render!="function"}))throw new Error(G("The widget definition expects a `render` and/or an `init` method."));return m.forEach(function(c){$(c)||(h&&c.dependsOn==="recommend"?h._hasRecommendWidget=!0:h?h._hasSearchWidget=!0:c.dependsOn==="recommend"?o=!0:i=!0,Kt(c))}),s=s.concat(m),h&&m.length&&(Vt(g,{state:X(s,{uiState:f,initialSearchParameters:g.state}),recommendState:Ot(s,{uiState:f,initialRecommendParameters:g.recommendState}),_uiState:f}),m.forEach(function(c){if(c.getRenderState){var l=c.getRenderState(h.renderState[v.getIndexId()]||{},ie(h,v,h._initialUiState));Ne({renderState:l,instantSearchInstance:h,parent:v})}}),m.forEach(function(c){c.init&&c.init(ie(h,v,h._initialUiState))}),h.scheduleSearch()),this},removeWidgets:function(m){var v=this;if(!Array.isArray(m))throw new Error(G("The `removeWidgets` method expects an array of widgets."));if(m.some(function(j){return typeof j.dispose!="function"}))throw new Error(G("The widget definition expects a `dispose` method."));if(s=s.filter(function(j){return m.indexOf(j)===-1}),s.forEach(function(j){$(j)||(h&&j.dependsOn==="recommend"?h._hasRecommendWidget=!0:h?h._hasSearchWidget=!0:j.dependsOn==="recommend"?o=!0:i=!0)}),h&&m.length){var c=m.reduce(function(j,O){var E=O.dispose({helper:g,state:j.cleanedSearchState,recommendState:j.cleanedRecommendState,parent:v});return E instanceof k.RecommendParameters?j.cleanedRecommendState=E:E&&(j.cleanedSearchState=E),j},{cleanedSearchState:g.state,cleanedRecommendState:g.recommendState}),l=c.cleanedSearchState,P=c.cleanedRecommendState,x=h.future.preserveSharedStateOnUnmount?X(s,{uiState:f,initialSearchParameters:new k.SearchParameters({index:this.getIndexName()})}):X(s,{uiState:Z(s,{searchParameters:l,helper:g}),initialSearchParameters:l});f=Z(s,{searchParameters:x,helper:g}),g.setState(x),g.recommendState=P,s.length&&h.scheduleSearch()}return this},init:function(m){var v=this,c,l=m.instantSearchInstance,P=m.parent,x=m.uiState;if(g===null){h=l,p=P,f=x[u]||{};var j=l.mainHelper,O=X(s,{uiState:f,initialSearchParameters:new k.SearchParameters({index:n})}),E=Ot(s,{uiState:f,initialRecommendParameters:new k.RecommendParameters});g=k({},O.index,O),g.recommendState=E,g.search=function(){return l.onStateChange?(l.onStateChange({uiState:l.mainIndex.getWidgetUiState({}),setUiState:function(S){return l.setUiState(S,!1)}}),j):j.search()},g.searchWithoutTriggeringOnStateChange=function(){return j.search()},g.searchForFacetValues=function(F,S,w,A){var C=g.state.setQueryParameters(A);return j.searchForFacetValues(F,S,w,C)},y=j.derive(function(){return Tr.apply(void 0,[j.state].concat(Lt(Qr(v))))},function(){return v.getHelper().recommendState});var d=(c=l._initialResults)===null||c===void 0?void 0:c[this.getIndexId()];if(d!=null&&d.results){var R=new k.SearchResults(new k.SearchParameters(d.state),d.results);y.lastResults=R,g.lastResults=R}if(d!=null&&d.recommendResults){var _=new k.RecommendResults(new k.RecommendParameters({params:d.recommendResults.params}),d.recommendResults.results);y.lastRecommendResults=_,g.lastRecommendResults=_}g.on("change",function(F){var S=F.isPageReset;S&&$t(s)}),y.on("search",function(){l.scheduleStalledRender()}),y.on("result",function(F){var S=F.results;l.scheduleRender(),g.lastResults=S,b=S?._state}),y.on("recommend:result",function(F){var S=F.recommend;l.scheduleRender(),g.lastRecommendResults=S.results}),s.forEach(function(F){if(F.getRenderState){var S=F.getRenderState(l.renderState[v.getIndexId()]||{},ie(l,v,x));Ne({renderState:S,instantSearchInstance:l,parent:v})}}),s.forEach(function(F){F.init&&F.init(ie(l,v,x))}),g.on("change",function(F){var S=F.state,w=F._uiState;f=Z(s,{searchParameters:S,helper:g},w||{}),l.onStateChange||l.onInternalStateChange()}),d&&l.scheduleRender(),o&&(l._hasRecommendWidget=!0),i&&(l._hasSearchWidget=!0)}},render:function(m){var v,c=this,l=m.instantSearchInstance;l.status==="error"&&!l.mainHelper.hasPendingRequests()&&b&&g.setState(b);var P=this.getResults()||(v=y)!==null&&v!==void 0&&v.lastRecommendResults?s:s.filter($);P=P.filter(function(x){return x.shouldRender?x.shouldRender({instantSearchInstance:l}):!0}),P.forEach(function(x){if(x.getRenderState){var j=x.getRenderState(l.renderState[c.getIndexId()]||{},Xe(l,c,x));Ne({renderState:j,instantSearchInstance:l,parent:c})}}),P.forEach(function(x){x.render&&x.render(Xe(l,c,x))})},dispose:function(){var m=this,v,c;s.forEach(function(l){l.dispose&&g&&l.dispose({helper:g,state:g.state,recommendState:g.recommendState,parent:m})}),h=null,p=null,(v=g)===null||v===void 0||v.removeAllListeners(),g=null,(c=y)===null||c===void 0||c.detach(),y=null},getWidgetUiState:function(m){return s.filter($).reduce(function(v,c){return c.getWidgetUiState(v)},V(V({},m),{},K({},u,V(V({},m[u]),f))))},getWidgetState:function(m){return this.getWidgetUiState(m)},getWidgetSearchParameters:function(m,v){var c=v.uiState;return X(s,{uiState:c,initialSearchParameters:m})},refreshUiState:function(){f=Z(s,{searchParameters:this.getHelper().state,helper:this.getHelper()},f)},setIndexUiState:function(m){var v=typeof m=="function"?m(f):m;h.setUiState(function(c){return V(V({},c),{},K({},u,v))})}}};function Ne(e){var t=e.renderState,n=e.instantSearchInstance,r=e.parent,u=r?r.getIndexId():n.mainIndex.getIndexId();n.renderState=V(V({},n.renderState),{},K({},u,V(V({},n.renderState[u]),t)))}export{ae as T,hn as a,dr as b,sn as c,ie as d,mn as e,fn as f,ln as g,hr as h,$ as i,vn as j,k,mr as l,Ke as m,cn as n,on as o,dn as p,or as q,Tt as r,ur as s,un as u};
