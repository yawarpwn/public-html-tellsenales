import{g as ze}from"./_commonjsHelpers.Cpj98o6Y.js";var Et="ais",Nn=function(t){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.descendantName,i=r.modifierName,a=n?"-".concat(n):"",c=i?"--".concat(i):"";return"".concat(Et,"-").concat(t).concat(a).concat(c)}},Ot=0;function Ht(e){e.dependsOn==="recommend"&&(e.$$id=Ot++)}function Wn(){}var Bn=function(t,r){return t},wt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Je=/[&<>"']/g,At=RegExp(Je.source);function Tt(e){return e&&At.test(e)?e.replace(Je,function(t){return wt[t]}):e}var Qt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ke=/&(amp|quot|lt|gt|#39);/g,Dt=RegExp(Ke.source);function Ln(e){return e&&Dt.test(e)?e.replace(Ke,function(t){return Qt[t]}):e}function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function It(e){return e===null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function $t(e){return ge(e)==="object"&&e!==null}function Ct(e){if(!$t(e)||It(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function K(e){"@babel/helpers - typeof";return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(e)}function Nt(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pe.apply(this,arguments)}function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?De(Object(r),!0).forEach(function(n){Ge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ge(e,t,r){return t=Wt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wt(e){var t=Bt(e,"string");return K(t)==="symbol"?t:String(t)}function Bt(e,t){if(K(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ie={highlightPreTag:"__ais-highlight__",highlightPostTag:"__/ais-highlight__"},re={highlightPreTag:"<mark>",highlightPostTag:"</mark>"};function Ze(e){return Tt(e).replace(new RegExp(Ie.highlightPreTag,"g"),re.highlightPreTag).replace(new RegExp(Ie.highlightPostTag,"g"),re.highlightPostTag)}function ne(e){return Ct(e)&&typeof e.value!="string"?Object.keys(e).reduce(function(t,r){return L(L({},t),{},Ge({},r,ne(e[r])))},{}):Array.isArray(e)?e.map(ne):L(L({},e),{},{value:Ze(e.value)})}function Un(e){return e.__escaped===void 0&&(e=e.map(function(t){var r=pe({},(Nt(t),t));return r._highlightResult&&(r._highlightResult=ne(r._highlightResult)),r._snippetResult&&(r._snippetResult=ne(r._snippetResult)),r}),e.__escaped=!0),e}function Mn(e){return e.map(function(t){return L(L({},t),{},{highlighted:Ze(t.highlighted)})})}function Lt(e){return btoa(encodeURIComponent(JSON.stringify(e)))}function Ut(e){return JSON.parse(decodeURIComponent(atob(e)))}function Q(e){return e.$$type==="ais.index"}function Mt(e){var t=e.name,r=e.connector,n=r===void 0?!1:r;return["https://www.algolia.com/doc/api-reference/widgets/",t,"/js/",n?"#connector":""].join("")}function Vt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.map(function(i){return Mt(i)}).join(", ");return function(i){return[i,"See documentation: ".concat(n)].filter(Boolean).join(`

`)}}function Vn(e,t){for(var r,n=0;n<e.length;n++)if(r=e[n],t(r,n,e))return r}function kt(e,t){if(!Array.isArray(e))return-1;for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function kn(e){var t=re.highlightPostTag,r=re.highlightPreTag,n=e.split(r),i=n.shift(),a=i?[{value:i,isHighlighted:!1}]:[];return n.forEach(function(c){var s=c.split(t);a.push({value:s[0],isHighlighted:!0}),s[1]!==""&&a.push({value:s[1],isHighlighted:!1})}),a}function qn(e,t){var r=Array.isArray(t)?t:t.split(".");return r.reduce(function(n,i){return n&&n[i]},e)}function $e(e){return e!==Object(e)}function qt(e,t){if(e===t)return!0;if($e(e)||$e(t)||typeof e=="function"||typeof t=="function")return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];if(!(i in t)||!qt(e[i],t[i]))return!1}return!0}function zt(e){return e.filter(function(t,r,n){return n.indexOf(t)===r})}function G(e){"@babel/helpers - typeof";return G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(e)}var Jt=["facets","disjunctiveFacets","facetsRefinements","facetsExcludes","disjunctiveFacetsRefinements","numericRefinements","tagRefinements","hierarchicalFacets","hierarchicalFacetsRefinements","ruleContexts"];function Ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ce(Object(r),!0).forEach(function(n){Kt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kt(e,t,r){return t=Gt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gt(e){var t=Zt(e,"string");return G(t)==="symbol"?t:String(t)}function Zt(e,t){if(G(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xt(e,t){if(e==null)return{};var r=Yt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Yt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var er=function(t,r){r.facets,r.disjunctiveFacets,r.facetsRefinements,r.facetsExcludes,r.disjunctiveFacetsRefinements,r.numericRefinements,r.tagRefinements,r.hierarchicalFacets,r.hierarchicalFacetsRefinements,r.ruleContexts;var n=Xt(r,Jt);return t.setQueryParameters(n)},tr=function(t,r){return r.facets.reduce(function(n,i){return n.addFacet(i)},t)},rr=function(t,r){return r.disjunctiveFacets.reduce(function(n,i){return n.addDisjunctiveFacet(i)},t)},nr=function(t,r){return t.setQueryParameters({hierarchicalFacets:r.hierarchicalFacets.reduce(function(n,i){var a=kt(n,function(s){return s.name===i.name});if(a===-1)return n.concat(i);var c=n.slice();return c.splice(a,1,i),c},t.hierarchicalFacets)})},ir=function(t,r){return r.tagRefinements.reduce(function(n,i){return n.addTagRefinement(i)},t)},ar=function(t,r){return t.setQueryParameters({facetsRefinements:D(D({},t.facetsRefinements),r.facetsRefinements)})},sr=function(t,r){return t.setQueryParameters({facetsExcludes:D(D({},t.facetsExcludes),r.facetsExcludes)})},cr=function(t,r){return t.setQueryParameters({disjunctiveFacetsRefinements:D(D({},t.disjunctiveFacetsRefinements),r.disjunctiveFacetsRefinements)})},ur=function(t,r){return t.setQueryParameters({numericRefinements:D(D({},t.numericRefinements),r.numericRefinements)})},or=function(t,r){return t.setQueryParameters({hierarchicalFacetsRefinements:D(D({},t.hierarchicalFacetsRefinements),r.hierarchicalFacetsRefinements)})},fr=function(t,r){var n=zt([].concat(t.ruleContexts).concat(r.ruleContexts).filter(Boolean));return n.length>0?t.setQueryParameters({ruleContexts:n}):t},hr=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.reduce(function(i,a){var c=or(i,a),s=nr(c,a),o=ir(s,a),u=ur(o,a),f=cr(u,a),d=sr(f,a),m=ar(d,a),v=rr(m,a),y=fr(v,a),h=tr(y,a);return er(h,a)})};function te(e,t,r){var n=t.getHelper();return{uiState:r,helper:n,parent:t,instantSearchInstance:e,state:n.state,renderState:e.renderState,templatesConfig:e.templatesConfig,createURL:t.createURL,scopedResults:[],searchMetadata:{isSearchStalled:e.status==="stalled"},status:e.status,error:e.error}}function Ne(e,t,r){var n=t.getResultsForWidget(r),i=t.getHelper();return{helper:i,parent:t,instantSearchInstance:e,results:n,scopedResults:t.getScopedResults(),state:n&&"_state"in n?n._state:i.state,renderState:e.renderState,templatesConfig:e.templatesConfig,createURL:t.createURL,searchMetadata:{isSearchStalled:e.status==="stalled"},status:e.status,error:e.error}}function lr(e){for(var t=e.getParent(),r=[e.getHelper().state];t!==null;)r=[t.getHelper().state].concat(r),t=t.getParent();return r}function zn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{fallback:function(){}},r=t.fallback;return typeof window>"u"?r():e({window})}function Re(e){"@babel/helpers - typeof";return Re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(e)}function Jn(e){var t=e.getAttribute("data-insights-method"),r=e.getAttribute("data-insights-payload");if(typeof r!="string")throw new Error("The insights helper expects `data-insights-payload` to be a base64-encoded JSON string.");try{var n=Ut(r);return{method:t,payload:n}}catch{throw new Error("The insights helper was unable to parse `data-insights-payload`.")}}function dr(e){var t=e.method,r=e.payload;if(Re(r)!=="object")throw new Error("The insights helper expects the payload to be an object.");var n;try{n=Lt(r)}catch{throw new Error("Could not JSON serialize the payload object.")}return'data-insights-method="'.concat(t,'" data-insights-payload="').concat(n,'"')}function Kn(e,t){return dr({method:e,payload:t})}function x(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var be=x;x.prototype._events=void 0;x.prototype._maxListeners=void 0;x.defaultMaxListeners=10;x.prototype.setMaxListeners=function(e){if(!mr(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this};x.prototype.emit=function(e){var t,r,n,i,a,c;if(this._events||(this._events={}),e==="error"&&(!this._events.error||Z(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(r=this._events[e],Xe(r))return!1;if($(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(Z(r))for(i=Array.prototype.slice.call(arguments,1),c=r.slice(),n=c.length,a=0;a<n;a++)c[a].apply(this,i);return!0};x.prototype.addListener=function(e,t){var r;if(!$(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,$(t.listener)?t.listener:t),this._events[e]?Z(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,Z(this._events[e])&&!this._events[e].warned&&(Xe(this._maxListeners)?r=x.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),typeof console.trace=="function"&&console.trace())),this};x.prototype.on=x.prototype.addListener;x.prototype.once=function(e,t){if(!$(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this};x.prototype.removeListener=function(e,t){var r,n,i,a;if(!$(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],i=r.length,n=-1,r===t||$(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(Z(r)){for(a=i;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(n<0)return this;r.length===1?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this};x.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[e]&&delete this._events[e],this;if(arguments.length===0){for(t in this._events)t!=="removeListener"&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],$(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this};x.prototype.listeners=function(e){var t;return!this._events||!this._events[e]?t=[]:$(this._events[e])?t=[this._events[e]]:t=this._events[e].slice(),t};x.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if($(t))return 1;if(t)return t.length}return 0};x.listenerCount=function(e,t){return e.listenerCount(t)};function $(e){return typeof e=="function"}function mr(e){return typeof e=="number"}function Z(e){return typeof e=="object"&&e!==null}function Xe(e){return e===void 0}const Gn=ze(be);function vr(e,t){e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}var Ye=vr,gr=be,pr=Ye;function Y(e,t,r){this.main=e,this.fn=t,this.recommendFn=r,this.lastResults=null,this.lastRecommendResults=null}pr(Y,gr);Y.prototype.detach=function(){this.removeAllListeners(),this.main.detachDerivedHelper(this)};Y.prototype.getModifiedState=function(e){return this.fn(e)};Y.prototype.getModifiedRecommendState=function(e){return this.recommendFn(e)};var Rr=Y;function yr(e){return typeof e!="string"?e:String(e).replace(/^-/,"\\-")}function Fr(e){return typeof e!="string"?e:e.replace(/^\\-/,"-")}var Se={escapeFacetValue:yr,unescapeFacetValue:Fr};function Pr(e){return typeof e=="object"&&e!==null?xe(Array.isArray(e)?[]:{},e):e}function ie(e){return typeof e=="function"||Array.isArray(e)||Object.prototype.toString.call(e)==="[object Object]"}function xe(e,t){if(e===t)return e;for(var r in t)if(!(!Object.prototype.hasOwnProperty.call(t,r)||r==="__proto__"||r==="constructor")){var n=t[r],i=e[r];typeof i<"u"&&typeof n>"u"||(ie(i)&&ie(n)?e[r]=xe(i,n):e[r]=Pr(n))}return e}function _r(e){ie(e)||(e={});for(var t=1,r=arguments.length;t<r;t++){var n=arguments[t];ie(n)&&xe(e,n)}return e}var se=_r;function jr(e){return e&&Object.keys(e).length>0}var Ee=jr;function br(e,t){if(e===null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var Oe=br;function J(e){e=e||{},this.params=e.params||[]}J.prototype={constructor:J,addParams:function(e){var t=this.params.slice();return t.push(e),new J({params:t})},removeParams:function(e){return new J({params:this.params.filter(function(t){return t.$$id!==e})})},addFrequentlyBoughtTogether:function(e){return this.addParams(Object.assign({},e,{model:"bought-together"}))},addRelatedProducts:function(e){return this.addParams(Object.assign({},e,{model:"related-products"}))},addTrendingItems:function(e){return this.addParams(Object.assign({},e,{model:"trending-items"}))},addTrendingFacets:function(e){return this.addParams(Object.assign({},e,{model:"trending-facets"}))},addLookingSimilar:function(e){return this.addParams(Object.assign({},e,{model:"looking-similar"}))},_buildQueries:function(e,t){return this.params.filter(function(r){return t[r.$$id]===void 0}).map(function(r){var n=Object.assign({},r,{indexName:e});return delete n.$$id,n})}};var et=J;function ye(e,t){this._state=e,this._rawResults={};var r=this;e.params.forEach(function(n){var i=n.$$id;r[i]=t[i],r._rawResults[i]=t[i]})}ye.prototype={constructor:ye};var tt=ye,ue=se;function oe(e){return Object.keys(e).sort().reduce(function(t,r){return t[r]=e[r],t},{})}var O={_getQueries:function(t,r){var n=[];return n.push({indexName:t,params:O._getHitsSearchParams(r)}),r.getRefinedDisjunctiveFacets().forEach(function(i){n.push({indexName:t,params:O._getDisjunctiveFacetSearchParams(r,i)})}),r.getRefinedHierarchicalFacets().forEach(function(i){var a=r.getHierarchicalFacetByName(i),c=r.getHierarchicalRefinement(i),s=r._getHierarchicalFacetSeparator(a);if(c.length>0&&c[0].split(s).length>1){var o=c[0].split(s).slice(0,-1).reduce(function(f,d,m){return f.concat({attribute:a.attributes[m],value:m===0?d:[f[f.length-1].value,d].join(s)})},[]);o.forEach(function(u,f){var d=O._getDisjunctiveFacetSearchParams(r,u.attribute,f===0);function m(h){return a.attributes.some(function(p){return p===h.split(":")[0]})}var v=(d.facetFilters||[]).reduce(function(h,p){if(Array.isArray(p)){var g=p.filter(function(R){return!m(R)});g.length>0&&h.push(g)}return typeof p=="string"&&!m(p)&&h.push(p),h},[]),y=o[f-1];f>0?d.facetFilters=v.concat(y.attribute+":"+y.value):d.facetFilters=v.length>0?v:void 0,n.push({indexName:t,params:d})})}}),n},_getHitsSearchParams:function(e){var t=e.facets.concat(e.disjunctiveFacets).concat(O._getHitsHierarchicalFacetsAttributes(e)).sort(),r=O._getFacetFilters(e),n=O._getNumericFilters(e),i=O._getTagFilters(e),a={facets:t.indexOf("*")>-1?["*"]:t,tagFilters:i};return r.length>0&&(a.facetFilters=r),n.length>0&&(a.numericFilters=n),oe(ue({},e.getQueryParams(),a))},_getDisjunctiveFacetSearchParams:function(e,t,r){var n=O._getFacetFilters(e,t,r),i=O._getNumericFilters(e,t),a=O._getTagFilters(e),c={hitsPerPage:0,page:0,analytics:!1,clickAnalytics:!1};a.length>0&&(c.tagFilters=a);var s=e.getHierarchicalFacetByName(t);return s?c.facets=O._getDisjunctiveHierarchicalFacetAttribute(e,s,r):c.facets=t,i.length>0&&(c.numericFilters=i),n.length>0&&(c.facetFilters=n),oe(ue({},e.getQueryParams(),c))},_getNumericFilters:function(e,t){if(e.numericFilters)return e.numericFilters;var r=[];return Object.keys(e.numericRefinements).forEach(function(n){var i=e.numericRefinements[n]||{};Object.keys(i).forEach(function(a){var c=i[a]||[];t!==n&&c.forEach(function(s){if(Array.isArray(s)){var o=s.map(function(u){return n+a+u});r.push(o)}else r.push(n+a+s)})})}),r},_getTagFilters:function(e){return e.tagFilters?e.tagFilters:e.tagRefinements.join(",")},_getFacetFilters:function(e,t,r){var n=[],i=e.facetsRefinements||{};Object.keys(i).sort().forEach(function(o){var u=i[o]||[];u.slice().sort().forEach(function(f){n.push(o+":"+f)})});var a=e.facetsExcludes||{};Object.keys(a).sort().forEach(function(o){var u=a[o]||[];u.sort().forEach(function(f){n.push(o+":-"+f)})});var c=e.disjunctiveFacetsRefinements||{};Object.keys(c).sort().forEach(function(o){var u=c[o]||[];if(!(o===t||!u||u.length===0)){var f=[];u.slice().sort().forEach(function(d){f.push(o+":"+d)}),n.push(f)}});var s=e.hierarchicalFacetsRefinements||{};return Object.keys(s).sort().forEach(function(o){var u=s[o]||[],f=u[0];if(f!==void 0){var d=e.getHierarchicalFacetByName(o),m=e._getHierarchicalFacetSeparator(d),v=e._getHierarchicalRootPath(d),y,h;if(t===o){if(f.indexOf(m)===-1||!v&&r===!0||v&&v.split(m).length===f.split(m).length)return;v?(h=v.split(m).length-1,f=v):(h=f.split(m).length-2,f=f.slice(0,f.lastIndexOf(m))),y=d.attributes[h]}else h=f.split(m).length-1,y=d.attributes[h];y&&n.push([y+":"+f])}}),n},_getHitsHierarchicalFacetsAttributes:function(e){var t=[];return e.hierarchicalFacets.reduce(function(n,i){var a=e.getHierarchicalRefinement(i.name)[0];if(!a)return n.push(i.attributes[0]),n;var c=e._getHierarchicalFacetSeparator(i),s=a.split(c).length,o=i.attributes.slice(0,s+1);return n.concat(o)},t)},_getDisjunctiveHierarchicalFacetAttribute:function(e,t,r){var n=e._getHierarchicalFacetSeparator(t);if(r===!0){var i=e._getHierarchicalRootPath(t),a=0;return i&&(a=i.split(n).length),[t.attributes[a]]}var c=e.getHierarchicalRefinement(t.name)[0]||"",s=c.split(n).length-1;return t.attributes.slice(0,s+1)},getSearchForFacetQuery:function(e,t,r,n){var i=n.isDisjunctiveFacet(e)?n.clearRefinements(e):n,a={facetQuery:t,facetName:e};return typeof r=="number"&&(a.maxFacetHits=r),oe(ue({},O._getHitsSearchParams(i),a))}},Sr=O,He=function(){var t=Array.prototype.slice.call(arguments);return t.reduceRight(function(r,n){return Object.keys(Object(n)).forEach(function(i){n[i]!==void 0&&(r[i]!==void 0&&delete r[i],r[i]=n[i])}),r},{})},ee=function(t,r){if(Array.isArray(t)){for(var n=0;n<t.length;n++)if(r(t[n]))return t[n]}};function xr(e,t){return e.filter(function(r,n){return t.indexOf(r)>-1&&e.indexOf(r)===n})}var Er=xr;function rt(e){if(typeof e=="number")return e;if(typeof e=="string")return parseFloat(e);if(Array.isArray(e))return e.map(rt);throw new Error("The value should be a number, a parsable string or an array of those.")}var Or=rt,Hr=function(t){return t===null?!1:/^[a-zA-Z0-9_-]{1,64}$/.test(t)},wr=He,Ar=Ee,Tr=Oe,W={addRefinement:function(t,r,n){if(W.isRefined(t,r,n))return t;var i=""+n,a=t[r]?t[r].concat(i):[i],c={};return c[r]=a,wr({},c,t)},removeRefinement:function(t,r,n){if(n===void 0)return W.clearRefinement(t,function(a,c){return r===c});var i=""+n;return W.clearRefinement(t,function(a,c){return r===c&&i===a})},toggleRefinement:function(t,r,n){if(n===void 0)throw new Error("toggleRefinement should be used with a value");return W.isRefined(t,r,n)?W.removeRefinement(t,r,n):W.addRefinement(t,r,n)},clearRefinement:function(t,r,n){if(r===void 0)return Ar(t)?{}:t;if(typeof r=="string")return Tr(t,[r]);if(typeof r=="function"){var i=!1,a=Object.keys(t).reduce(function(c,s){var o=t[s]||[],u=o.filter(function(f){return!r(f,s,n)});return u.length!==o.length&&(i=!0),c[s]=u,c},{});return i?a:t}},isRefined:function(t,r,n){var i=!!t[r]&&t[r].length>0;if(n===void 0||!i)return i;var a=""+n;return t[r].indexOf(a)!==-1}},Qr=W,fe=He,nt=ee,We=Er,Fe=se,Pe=Ee,Be=Oe,he=Or,Dr=Hr,_=Qr;function we(e,t){return Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every(function(r,n){return we(t[n],r)}):e===t}function Ir(e,t){return nt(e,function(r){return we(r,t)})}function E(e){var t=e?E._parseNumbers(e):{};t.userToken!==void 0&&!Dr(t.userToken)&&console.warn("[algoliasearch-helper] The `userToken` parameter is invalid. This can lead to wrong analytics.\n  - Format: [a-zA-Z0-9_-]{1,64}"),this.facets=t.facets||[],this.disjunctiveFacets=t.disjunctiveFacets||[],this.hierarchicalFacets=t.hierarchicalFacets||[],this.facetsRefinements=t.facetsRefinements||{},this.facetsExcludes=t.facetsExcludes||{},this.disjunctiveFacetsRefinements=t.disjunctiveFacetsRefinements||{},this.numericRefinements=t.numericRefinements||{},this.tagRefinements=t.tagRefinements||[],this.hierarchicalFacetsRefinements=t.hierarchicalFacetsRefinements||{};var r=this;Object.keys(t).forEach(function(n){var i=E.PARAMETERS.indexOf(n)!==-1,a=t[n]!==void 0;!i&&a&&(r[n]=t[n])})}E.PARAMETERS=Object.keys(new E);E._parseNumbers=function(e){if(e instanceof E)return e;var t={},r=["aroundPrecision","aroundRadius","getRankingInfo","minWordSizefor2Typos","minWordSizefor1Typo","page","maxValuesPerFacet","distinct","minimumAroundRadius","hitsPerPage","minProximity"];if(r.forEach(function(i){var a=e[i];if(typeof a=="string"){var c=parseFloat(a);t[i]=isNaN(c)?a:c}}),Array.isArray(e.insideBoundingBox)&&(t.insideBoundingBox=e.insideBoundingBox.map(function(i){return Array.isArray(i)?i.map(function(a){return parseFloat(a)}):i})),e.numericRefinements){var n={};Object.keys(e.numericRefinements).forEach(function(i){var a=e.numericRefinements[i]||{};n[i]={},Object.keys(a).forEach(function(c){var s=a[c],o=s.map(function(u){return Array.isArray(u)?u.map(function(f){return typeof f=="string"?parseFloat(f):f}):typeof u=="string"?parseFloat(u):u});n[i][c]=o})}),t.numericRefinements=n}return Fe(e,t)};E.make=function(t){var r=new E(t),n=t.hierarchicalFacets||[];return n.forEach(function(i){if(i.rootPath){var a=r.getHierarchicalRefinement(i.name);a.length>0&&a[0].indexOf(i.rootPath)!==0&&(r=r.clearRefinements(i.name)),a=r.getHierarchicalRefinement(i.name),a.length===0&&(r=r.toggleHierarchicalFacetRefinement(i.name,i.rootPath))}}),r};E.validate=function(e,t){var r=t||{};return e.tagFilters&&r.tagRefinements&&r.tagRefinements.length>0?new Error("[Tags] Cannot switch from the managed tag API to the advanced API. It is probably an error, if it is really what you want, you should first clear the tags with clearTags method."):e.tagRefinements.length>0&&r.tagFilters?new Error("[Tags] Cannot switch from the advanced tag API to the managed API. It is probably an error, if it is not, you should first clear the tags with clearTags method."):e.numericFilters&&r.numericRefinements&&Pe(r.numericRefinements)?new Error("[Numeric filters] Can't switch from the advanced to the managed API. It is probably an error, if this is really what you want, you have to first clear the numeric filters."):Pe(e.numericRefinements)&&r.numericFilters?new Error("[Numeric filters] Can't switch from the managed API to the advanced. It is probably an error, if this is really what you want, you have to first clear the numeric filters."):null};E.prototype={constructor:E,clearRefinements:function(t){var r={numericRefinements:this._clearNumericRefinements(t),facetsRefinements:_.clearRefinement(this.facetsRefinements,t,"conjunctiveFacet"),facetsExcludes:_.clearRefinement(this.facetsExcludes,t,"exclude"),disjunctiveFacetsRefinements:_.clearRefinement(this.disjunctiveFacetsRefinements,t,"disjunctiveFacet"),hierarchicalFacetsRefinements:_.clearRefinement(this.hierarchicalFacetsRefinements,t,"hierarchicalFacet")};return r.numericRefinements===this.numericRefinements&&r.facetsRefinements===this.facetsRefinements&&r.facetsExcludes===this.facetsExcludes&&r.disjunctiveFacetsRefinements===this.disjunctiveFacetsRefinements&&r.hierarchicalFacetsRefinements===this.hierarchicalFacetsRefinements?this:this.setQueryParameters(r)},clearTags:function(){return this.tagFilters===void 0&&this.tagRefinements.length===0?this:this.setQueryParameters({tagFilters:void 0,tagRefinements:[]})},setIndex:function(t){return t===this.index?this:this.setQueryParameters({index:t})},setQuery:function(t){return t===this.query?this:this.setQueryParameters({query:t})},setPage:function(t){return t===this.page?this:this.setQueryParameters({page:t})},setFacets:function(t){return this.setQueryParameters({facets:t})},setDisjunctiveFacets:function(t){return this.setQueryParameters({disjunctiveFacets:t})},setHitsPerPage:function(t){return this.hitsPerPage===t?this:this.setQueryParameters({hitsPerPage:t})},setTypoTolerance:function(t){return this.typoTolerance===t?this:this.setQueryParameters({typoTolerance:t})},addNumericRefinement:function(e,t,r){var n=he(r);if(this.isNumericRefined(e,t,n))return this;var i=Fe({},this.numericRefinements);return i[e]=Fe({},i[e]),i[e][t]?(i[e][t]=i[e][t].slice(),i[e][t].push(n)):i[e][t]=[n],this.setQueryParameters({numericRefinements:i})},getConjunctiveRefinements:function(e){return this.isConjunctiveFacet(e)?this.facetsRefinements[e]||[]:[]},getDisjunctiveRefinements:function(e){return this.isDisjunctiveFacet(e)?this.disjunctiveFacetsRefinements[e]||[]:[]},getHierarchicalRefinement:function(e){return this.hierarchicalFacetsRefinements[e]||[]},getExcludeRefinements:function(e){return this.isConjunctiveFacet(e)?this.facetsExcludes[e]||[]:[]},removeNumericRefinement:function(e,t,r){var n=r;return n!==void 0?this.isNumericRefined(e,t,n)?this.setQueryParameters({numericRefinements:this._clearNumericRefinements(function(i,a){return a===e&&i.op===t&&we(i.val,he(n))})}):this:t!==void 0?this.isNumericRefined(e,t)?this.setQueryParameters({numericRefinements:this._clearNumericRefinements(function(i,a){return a===e&&i.op===t})}):this:this.isNumericRefined(e)?this.setQueryParameters({numericRefinements:this._clearNumericRefinements(function(i,a){return a===e})}):this},getNumericRefinements:function(e){return this.numericRefinements[e]||{}},getNumericRefinement:function(e,t){return this.numericRefinements[e]&&this.numericRefinements[e][t]},_clearNumericRefinements:function(t){if(t===void 0)return Pe(this.numericRefinements)?{}:this.numericRefinements;if(typeof t=="string")return Be(this.numericRefinements,[t]);if(typeof t=="function"){var r=!1,n=this.numericRefinements,i=Object.keys(n).reduce(function(a,c){var s=n[c],o={};return s=s||{},Object.keys(s).forEach(function(u){var f=s[u]||[],d=[];f.forEach(function(m){var v=t({val:m,op:u},c,"numeric");v||d.push(m)}),d.length!==f.length&&(r=!0),o[u]=d}),a[c]=o,a},{});return r?i:this.numericRefinements}},addFacet:function(t){return this.isConjunctiveFacet(t)?this:this.setQueryParameters({facets:this.facets.concat([t])})},addDisjunctiveFacet:function(t){return this.isDisjunctiveFacet(t)?this:this.setQueryParameters({disjunctiveFacets:this.disjunctiveFacets.concat([t])})},addHierarchicalFacet:function(t){if(this.isHierarchicalFacet(t.name))throw new Error("Cannot declare two hierarchical facets with the same name: `"+t.name+"`");return this.setQueryParameters({hierarchicalFacets:this.hierarchicalFacets.concat([t])})},addFacetRefinement:function(t,r){if(!this.isConjunctiveFacet(t))throw new Error(t+" is not defined in the facets attribute of the helper configuration");return _.isRefined(this.facetsRefinements,t,r)?this:this.setQueryParameters({facetsRefinements:_.addRefinement(this.facetsRefinements,t,r)})},addExcludeRefinement:function(t,r){if(!this.isConjunctiveFacet(t))throw new Error(t+" is not defined in the facets attribute of the helper configuration");return _.isRefined(this.facetsExcludes,t,r)?this:this.setQueryParameters({facetsExcludes:_.addRefinement(this.facetsExcludes,t,r)})},addDisjunctiveFacetRefinement:function(t,r){if(!this.isDisjunctiveFacet(t))throw new Error(t+" is not defined in the disjunctiveFacets attribute of the helper configuration");return _.isRefined(this.disjunctiveFacetsRefinements,t,r)?this:this.setQueryParameters({disjunctiveFacetsRefinements:_.addRefinement(this.disjunctiveFacetsRefinements,t,r)})},addTagRefinement:function(t){if(this.isTagRefined(t))return this;var r={tagRefinements:this.tagRefinements.concat(t)};return this.setQueryParameters(r)},removeFacet:function(t){return this.isConjunctiveFacet(t)?this.clearRefinements(t).setQueryParameters({facets:this.facets.filter(function(r){return r!==t})}):this},removeDisjunctiveFacet:function(t){return this.isDisjunctiveFacet(t)?this.clearRefinements(t).setQueryParameters({disjunctiveFacets:this.disjunctiveFacets.filter(function(r){return r!==t})}):this},removeHierarchicalFacet:function(t){return this.isHierarchicalFacet(t)?this.clearRefinements(t).setQueryParameters({hierarchicalFacets:this.hierarchicalFacets.filter(function(r){return r.name!==t})}):this},removeFacetRefinement:function(t,r){if(!this.isConjunctiveFacet(t))throw new Error(t+" is not defined in the facets attribute of the helper configuration");return _.isRefined(this.facetsRefinements,t,r)?this.setQueryParameters({facetsRefinements:_.removeRefinement(this.facetsRefinements,t,r)}):this},removeExcludeRefinement:function(t,r){if(!this.isConjunctiveFacet(t))throw new Error(t+" is not defined in the facets attribute of the helper configuration");return _.isRefined(this.facetsExcludes,t,r)?this.setQueryParameters({facetsExcludes:_.removeRefinement(this.facetsExcludes,t,r)}):this},removeDisjunctiveFacetRefinement:function(t,r){if(!this.isDisjunctiveFacet(t))throw new Error(t+" is not defined in the disjunctiveFacets attribute of the helper configuration");return _.isRefined(this.disjunctiveFacetsRefinements,t,r)?this.setQueryParameters({disjunctiveFacetsRefinements:_.removeRefinement(this.disjunctiveFacetsRefinements,t,r)}):this},removeTagRefinement:function(t){if(!this.isTagRefined(t))return this;var r={tagRefinements:this.tagRefinements.filter(function(n){return n!==t})};return this.setQueryParameters(r)},toggleRefinement:function(t,r){return this.toggleFacetRefinement(t,r)},toggleFacetRefinement:function(t,r){if(this.isHierarchicalFacet(t))return this.toggleHierarchicalFacetRefinement(t,r);if(this.isConjunctiveFacet(t))return this.toggleConjunctiveFacetRefinement(t,r);if(this.isDisjunctiveFacet(t))return this.toggleDisjunctiveFacetRefinement(t,r);throw new Error("Cannot refine the undeclared facet "+t+"; it should be added to the helper options facets, disjunctiveFacets or hierarchicalFacets")},toggleConjunctiveFacetRefinement:function(t,r){if(!this.isConjunctiveFacet(t))throw new Error(t+" is not defined in the facets attribute of the helper configuration");return this.setQueryParameters({facetsRefinements:_.toggleRefinement(this.facetsRefinements,t,r)})},toggleExcludeFacetRefinement:function(t,r){if(!this.isConjunctiveFacet(t))throw new Error(t+" is not defined in the facets attribute of the helper configuration");return this.setQueryParameters({facetsExcludes:_.toggleRefinement(this.facetsExcludes,t,r)})},toggleDisjunctiveFacetRefinement:function(t,r){if(!this.isDisjunctiveFacet(t))throw new Error(t+" is not defined in the disjunctiveFacets attribute of the helper configuration");return this.setQueryParameters({disjunctiveFacetsRefinements:_.toggleRefinement(this.disjunctiveFacetsRefinements,t,r)})},toggleHierarchicalFacetRefinement:function(t,r){if(!this.isHierarchicalFacet(t))throw new Error(t+" is not defined in the hierarchicalFacets attribute of the helper configuration");var n=this._getHierarchicalFacetSeparator(this.getHierarchicalFacetByName(t)),i={},a=this.hierarchicalFacetsRefinements[t]!==void 0&&this.hierarchicalFacetsRefinements[t].length>0&&(this.hierarchicalFacetsRefinements[t][0]===r||this.hierarchicalFacetsRefinements[t][0].indexOf(r+n)===0);return a?r.indexOf(n)===-1?i[t]=[]:i[t]=[r.slice(0,r.lastIndexOf(n))]:i[t]=[r],this.setQueryParameters({hierarchicalFacetsRefinements:fe({},i,this.hierarchicalFacetsRefinements)})},addHierarchicalFacetRefinement:function(e,t){if(this.isHierarchicalFacetRefined(e))throw new Error(e+" is already refined.");if(!this.isHierarchicalFacet(e))throw new Error(e+" is not defined in the hierarchicalFacets attribute of the helper configuration.");var r={};return r[e]=[t],this.setQueryParameters({hierarchicalFacetsRefinements:fe({},r,this.hierarchicalFacetsRefinements)})},removeHierarchicalFacetRefinement:function(e){if(!this.isHierarchicalFacetRefined(e))return this;var t={};return t[e]=[],this.setQueryParameters({hierarchicalFacetsRefinements:fe({},t,this.hierarchicalFacetsRefinements)})},toggleTagRefinement:function(t){return this.isTagRefined(t)?this.removeTagRefinement(t):this.addTagRefinement(t)},isDisjunctiveFacet:function(e){return this.disjunctiveFacets.indexOf(e)>-1},isHierarchicalFacet:function(e){return this.getHierarchicalFacetByName(e)!==void 0},isConjunctiveFacet:function(e){return this.facets.indexOf(e)>-1},isFacetRefined:function(t,r){return this.isConjunctiveFacet(t)?_.isRefined(this.facetsRefinements,t,r):!1},isExcludeRefined:function(t,r){return this.isConjunctiveFacet(t)?_.isRefined(this.facetsExcludes,t,r):!1},isDisjunctiveFacetRefined:function(t,r){return this.isDisjunctiveFacet(t)?_.isRefined(this.disjunctiveFacetsRefinements,t,r):!1},isHierarchicalFacetRefined:function(t,r){if(!this.isHierarchicalFacet(t))return!1;var n=this.getHierarchicalRefinement(t);return r?n.indexOf(r)!==-1:n.length>0},isNumericRefined:function(t,r,n){if(n===void 0&&r===void 0)return!!this.numericRefinements[t];var i=this.numericRefinements[t]&&this.numericRefinements[t][r]!==void 0;if(n===void 0||!i)return i;var a=he(n),c=Ir(this.numericRefinements[t][r],a)!==void 0;return i&&c},isTagRefined:function(t){return this.tagRefinements.indexOf(t)!==-1},getRefinedDisjunctiveFacets:function(){var t=this,r=We(Object.keys(this.numericRefinements).filter(function(n){return Object.keys(t.numericRefinements[n]).length>0}),this.disjunctiveFacets);return Object.keys(this.disjunctiveFacetsRefinements).filter(function(n){return t.disjunctiveFacetsRefinements[n].length>0}).concat(r).concat(this.getRefinedHierarchicalFacets()).sort()},getRefinedHierarchicalFacets:function(){var t=this;return We(this.hierarchicalFacets.map(function(r){return r.name}),Object.keys(this.hierarchicalFacetsRefinements).filter(function(r){return t.hierarchicalFacetsRefinements[r].length>0})).sort()},getUnrefinedDisjunctiveFacets:function(){var e=this.getRefinedDisjunctiveFacets();return this.disjunctiveFacets.filter(function(t){return e.indexOf(t)===-1})},managedParameters:["index","facets","disjunctiveFacets","facetsRefinements","hierarchicalFacets","facetsExcludes","disjunctiveFacetsRefinements","numericRefinements","tagRefinements","hierarchicalFacetsRefinements"],getQueryParams:function(){var t=this.managedParameters,r={},n=this;return Object.keys(this).forEach(function(i){var a=n[i];t.indexOf(i)===-1&&a!==void 0&&(r[i]=a)}),r},setQueryParameter:function(t,r){if(this[t]===r)return this;var n={};return n[t]=r,this.setQueryParameters(n)},setQueryParameters:function(t){if(!t)return this;var r=E.validate(this,t);if(r)throw r;var n=this,i=E._parseNumbers(t),a=Object.keys(this).reduce(function(s,o){return s[o]=n[o],s},{}),c=Object.keys(i).reduce(function(s,o){var u=s[o]!==void 0,f=i[o]!==void 0;return u&&!f?Be(s,[o]):(f&&(s[o]=i[o]),s)},a);return new this.constructor(c)},resetPage:function(){return this.page===void 0?this:this.setPage(0)},_getHierarchicalFacetSortBy:function(e){return e.sortBy||["isRefined:desc","name:asc"]},_getHierarchicalFacetSeparator:function(e){return e.separator||" > "},_getHierarchicalRootPath:function(e){return e.rootPath||null},_getHierarchicalShowParentLevel:function(e){return typeof e.showParentLevel=="boolean"?e.showParentLevel:!0},getHierarchicalFacetByName:function(e){return nt(this.hierarchicalFacets,function(t){return t.name===e})},getHierarchicalFacetBreadcrumb:function(e){if(!this.isHierarchicalFacet(e))return[];var t=this.getHierarchicalRefinement(e)[0];if(!t)return[];var r=this._getHierarchicalFacetSeparator(this.getHierarchicalFacetByName(e)),n=t.split(r);return n.map(function(i){return i.trim()})},toString:function(){return JSON.stringify(this,null,2)}};var it=E,$r=function(t){return Array.isArray(t)?t.filter(Boolean):[]},Cr=function(t,r){if(!Array.isArray(t))return-1;for(var n=0;n<t.length;n++)if(r(t[n]))return n;return-1},Nr=ee,at=function(t,r){var n=(r||[]).map(function(i){return i.split(":")});return t.reduce(function(a,c){var s=c.split(":"),o=Nr(n,function(u){return u[0]===s[0]});return s.length>1||!o?(a[0].push(s[0]),a[1].push(s[1]),a):(a[0].push(o[0]),a[1].push(o[1]),a)},[[],[]])};function Wr(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=t!==void 0,a=t===null;if(!a&&e>t||n&&i||!r)return 1;if(!n&&e<t||a&&r||!i)return-1}return 0}function Br(e,t,r){if(!Array.isArray(e))return[];Array.isArray(r)||(r=[]);var n=e.map(function(i,a){return{criteria:t.map(function(c){return i[c]}),index:a,value:i}});return n.sort(function(a,c){for(var s=-1;++s<a.criteria.length;){var o=Wr(a.criteria[s],c.criteria[s]);if(o)return s>=r.length?o:r[s]==="desc"?-o:o}return a.index-c.index}),n.map(function(i){return i.value})}var st=Br,Lr=zr,ct=Se,Ur=ee,Mr=at,Vr=st,kr=ct.escapeFacetValue,qr=ct.unescapeFacetValue;function zr(e){return function(r,n){var i=e.hierarchicalFacets[n],a=e.hierarchicalFacetsRefinements[i.name]&&e.hierarchicalFacetsRefinements[i.name][0]||"",c=e._getHierarchicalFacetSeparator(i),s=e._getHierarchicalRootPath(i),o=e._getHierarchicalShowParentLevel(i),u=Mr(e._getHierarchicalFacetSortBy(i)),f=r.every(function(v){return v.exhaustive}),d=Jr(u,c,s,o,a),m=r;return s&&(m=r.slice(s.split(c).length)),m.reduce(d,{name:e.hierarchicalFacets[n].name,count:null,isRefined:!0,path:null,escapedValue:null,exhaustive:f,data:null})}}function Jr(e,t,r,n,i){return function(c,s,o){var u=c;if(o>0){var f=0;for(u=c;f<o;){var d=u&&Array.isArray(u.data)?u.data:[];u=Ur(d,function(v){return v.isRefined}),f++}}if(u){var m=Object.keys(s.data).map(function(v){return[v,s.data[v]]}).filter(function(v){var y=v[0];return Kr(y,u.path||r,i,t,r,n)});u.data=Vr(m.map(function(v){var y=v[0],h=v[1];return Gr(h,y,t,qr(i),s.exhaustive)}),e[0],e[1])}return c}}function Kr(e,t,r,n,i,a){return i&&(e.indexOf(i)!==0||i===e)?!1:!i&&e.indexOf(n)===-1||i&&e.split(n).length-i.split(n).length===1||e.indexOf(n)===-1&&r.indexOf(n)===-1||r.indexOf(e)===0||e.indexOf(t+n)===0&&(a||e.indexOf(r)===0)}function Gr(e,t,r,n,i){var a=t.split(r);return{name:a[a.length-1].trim(),path:t,escapedValue:kr(t),count:e,isRefined:n===t||n.indexOf(t+r)===0,exhaustive:i,data:null}}var le=$r,ae=He,ut=Se,w=ee,V=Cr,Zr=at,Le=se,ot=st,Ue=ut.escapeFacetValue,ft=ut.unescapeFacetValue,Xr=Lr;function Me(e){var t={};return e.forEach(function(r,n){t[r]=n}),t}function de(e,t,r){t&&t[r]&&(e.stats=t[r])}function Yr(e,t){return w(e,function(n){var i=n.attributes||[];return i.indexOf(t)>-1})}function C(e,t,r){var n=t[0];this._rawResults=t;var i=this;Object.keys(n).forEach(function(d){i[d]=n[d]});var a=Le({persistHierarchicalRootCount:!1},r);Object.keys(a).forEach(function(d){i[d]=a[d]}),this.processingTimeMS=t.reduce(function(d,m){return m.processingTimeMS===void 0?d:d+m.processingTimeMS},0),this.disjunctiveFacets=[],this.hierarchicalFacets=e.hierarchicalFacets.map(function(){return[]}),this.facets=[];var c=e.getRefinedDisjunctiveFacets(),s=Me(e.facets),o=Me(e.disjunctiveFacets),u=1,f=n.facets||{};Object.keys(f).forEach(function(d){var m=f[d],v=Yr(e.hierarchicalFacets,d);if(v){var y=v.attributes.indexOf(d),h=V(e.hierarchicalFacets,function(j){return j.name===v.name});i.hierarchicalFacets[h][y]={attribute:d,data:m,exhaustive:n.exhaustiveFacetsCount}}else{var p=e.disjunctiveFacets.indexOf(d)!==-1,g=e.facets.indexOf(d)!==-1,R;p&&(R=o[d],i.disjunctiveFacets[R]={name:d,data:m,exhaustive:n.exhaustiveFacetsCount},de(i.disjunctiveFacets[R],n.facets_stats,d)),g&&(R=s[d],i.facets[R]={name:d,data:m,exhaustive:n.exhaustiveFacetsCount},de(i.facets[R],n.facets_stats,d))}}),this.hierarchicalFacets=le(this.hierarchicalFacets),c.forEach(function(d){var m=t[u],v=m&&m.facets?m.facets:{},y=e.getHierarchicalFacetByName(d);Object.keys(v).forEach(function(h){var p=v[h],g;if(y){g=V(e.hierarchicalFacets,function(F){return F.name===y.name});var R=V(i.hierarchicalFacets[g],function(F){return F.attribute===h});if(R===-1)return;i.hierarchicalFacets[g][R].data=Le({},i.hierarchicalFacets[g][R].data,p)}else{g=o[h];var j=n.facets&&n.facets[h]||{};i.disjunctiveFacets[g]={name:h,data:ae({},p,j),exhaustive:m.exhaustiveFacetsCount},de(i.disjunctiveFacets[g],m.facets_stats,h),e.disjunctiveFacetsRefinements[h]&&e.disjunctiveFacetsRefinements[h].forEach(function(F){!i.disjunctiveFacets[g].data[F]&&e.disjunctiveFacetsRefinements[h].indexOf(ft(F))>-1&&(i.disjunctiveFacets[g].data[F]=0)})}}),u++}),e.getRefinedHierarchicalFacets().forEach(function(d){var m=e.getHierarchicalFacetByName(d),v=e._getHierarchicalFacetSeparator(m),y=e.getHierarchicalRefinement(d);y.length===0||y[0].split(v).length<2||t.slice(u).forEach(function(h){var p=h&&h.facets?h.facets:{};Object.keys(p).forEach(function(g){var R=p[g],j=V(e.hierarchicalFacets,function(A){return A.name===m.name}),F=V(i.hierarchicalFacets[j],function(A){return A.attribute===g});if(F!==-1){var P={};if(y.length>0&&!i.persistHierarchicalRootCount){var N=y[0].split(v)[0];P[N]=i.hierarchicalFacets[j][F].data[N]}i.hierarchicalFacets[j][F].data=ae(P,R,i.hierarchicalFacets[j][F].data)}}),u++})}),Object.keys(e.facetsExcludes).forEach(function(d){var m=e.facetsExcludes[d],v=s[d];i.facets[v]={name:d,data:f[d],exhaustive:n.exhaustiveFacetsCount},m.forEach(function(y){i.facets[v]=i.facets[v]||{name:d},i.facets[v].data=i.facets[v].data||{},i.facets[v].data[y]=0})}),this.hierarchicalFacets=this.hierarchicalFacets.map(Xr(e)),this.facets=le(this.facets),this.disjunctiveFacets=le(this.disjunctiveFacets),this._state=e}C.prototype.getFacetByName=function(e){function t(r){return r.name===e}return w(this.facets,t)||w(this.disjunctiveFacets,t)||w(this.hierarchicalFacets,t)};function en(e,t){function r(f){return f.name===t}if(e._state.isConjunctiveFacet(t)){var n=w(e.facets,r);return n?Object.keys(n.data).map(function(f){var d=Ue(f);return{name:f,escapedValue:d,count:n.data[f],isRefined:e._state.isFacetRefined(t,d),isExcluded:e._state.isExcludeRefined(t,f)}}):[]}else if(e._state.isDisjunctiveFacet(t)){var i=w(e.disjunctiveFacets,r);return i?Object.keys(i.data).map(function(f){var d=Ue(f);return{name:f,escapedValue:d,count:i.data[f],isRefined:e._state.isDisjunctiveFacetRefined(t,d)}}):[]}else if(e._state.isHierarchicalFacet(t)){var a=w(e.hierarchicalFacets,r);if(!a)return a;var c=e._state.getHierarchicalFacetByName(t),s=e._state._getHierarchicalFacetSeparator(c),o=ft(e._state.getHierarchicalRefinement(t)[0]||"");o.indexOf(c.rootPath)===0&&(o=o.replace(c.rootPath+s,""));var u=o.split(s);return u.unshift(t),ht(a,u,0),a}}function ht(e,t,r){e.isRefined=e.name===(t[r]&&t[r].trim()),e.data&&e.data.forEach(function(n){ht(n,t,r+1)})}function lt(e,t,r,n){if(n=n||0,Array.isArray(t))return e(t,r[n]);if(!t.data||t.data.length===0)return t;var i=t.data.map(function(s){return lt(e,s,r,n+1)}),a=e(i,r[n]),c=ae({data:a},t);return c}C.DEFAULT_SORT=["isRefined:desc","count:desc","name:asc"];function tn(e,t){return t.sort(e)}function rn(e,t){var r=[],n=[],i=t.order||[],a=i.reduce(function(o,u,f){return o[u]=f,o},{});e.forEach(function(o){var u=o.path||o.name;a[u]!==void 0?r[a[u]]=o:n.push(o)}),r=r.filter(function(o){return o});var c=t.sortRemainingBy,s;return c==="hidden"?r:(c==="alpha"?s=[["path","name"],["asc","asc"]]:s=[["count"],["desc"]],r.concat(ot(n,s[0],s[1])))}function nn(e,t){return e.renderingContent&&e.renderingContent.facetOrdering&&e.renderingContent.facetOrdering.values&&e.renderingContent.facetOrdering.values[t]}C.prototype.getFacetValues=function(e,t){var r=en(this,e);if(r){var n=ae({},t,{sortBy:C.DEFAULT_SORT,facetOrdering:!(t&&t.sortBy)}),i=this,a;if(Array.isArray(r))a=[e];else{var c=i._state.getHierarchicalFacetByName(r.name);a=c.attributes}return lt(function(s,o){if(n.facetOrdering){var u=nn(i,o);if(u)return rn(s,u)}if(Array.isArray(n.sortBy)){var f=Zr(n.sortBy,C.DEFAULT_SORT);return ot(s,f[0],f[1])}else if(typeof n.sortBy=="function")return tn(n.sortBy,s);throw new Error("options.sortBy is optional but if defined it must be either an array of string (predicates) or a sorting function")},r,a)}};C.prototype.getFacetStats=function(e){if(this._state.isConjunctiveFacet(e))return Ve(this.facets,e);if(this._state.isDisjunctiveFacet(e))return Ve(this.disjunctiveFacets,e)};function Ve(e,t){var r=w(e,function(n){return n.name===t});return r&&r.stats}C.prototype.getRefinements=function(){var e=this._state,t=this,r=[];return Object.keys(e.facetsRefinements).forEach(function(n){e.facetsRefinements[n].forEach(function(i){r.push(me(e,"facet",n,i,t.facets))})}),Object.keys(e.facetsExcludes).forEach(function(n){e.facetsExcludes[n].forEach(function(i){r.push(me(e,"exclude",n,i,t.facets))})}),Object.keys(e.disjunctiveFacetsRefinements).forEach(function(n){e.disjunctiveFacetsRefinements[n].forEach(function(i){r.push(me(e,"disjunctive",n,i,t.disjunctiveFacets))})}),Object.keys(e.hierarchicalFacetsRefinements).forEach(function(n){e.hierarchicalFacetsRefinements[n].forEach(function(i){r.push(an(e,n,i,t.hierarchicalFacets))})}),Object.keys(e.numericRefinements).forEach(function(n){var i=e.numericRefinements[n];Object.keys(i).forEach(function(a){i[a].forEach(function(c){r.push({type:"numeric",attributeName:n,name:c,numericValue:c,operator:a})})})}),e.tagRefinements.forEach(function(n){r.push({type:"tag",attributeName:"_tags",name:n})}),r};function me(e,t,r,n,i){var a=w(i,function(o){return o.name===r}),c=a&&a.data&&a.data[n]?a.data[n]:0,s=a&&a.exhaustive||!1;return{type:t,attributeName:r,name:n,count:c,exhaustive:s}}function an(e,t,r,n){var i=e.getHierarchicalFacetByName(t),a=e._getHierarchicalFacetSeparator(i),c=r.split(a),s=w(n,function(m){return m.name===t}),o=c.reduce(function(m,v){var y=m&&w(m.data,function(h){return h.name===v});return y!==void 0?y:m},s),u=o&&o.count||0,f=o&&o.exhaustive||!1,d=o&&o.path||"";return{type:"hierarchical",attributeName:t,name:d,count:u,exhaustive:f}}var dt=C,sn=function(t){return t.reduce(function(r,n){return r.concat(n)},[])},cn=ee,un=sn;function on(e,t){var r=[];return Object.keys(e).forEach(function(n){e[n].count<2&&(e[n].indexSum+=100),r.push({objectID:n,avgOfIndices:e[n].indexSum/t})}),r.sort(function(n,i){return n.avgOfIndices>i.avgOfIndices?1:-1})}function fn(e){var t={};e.forEach(function(i){i.forEach(function(a,c){t[a.objectID]?t[a.objectID]={indexSum:t[a.objectID].indexSum+c,count:t[a.objectID].count+1}:t[a.objectID]={indexSum:c,count:1}})});var r=on(t,e.length),n=r.reduce(function(i,a){var c=cn(un(e),function(s){return s.objectID===a.objectID});return c?i.concat(c):i},[]);return n}var hn=fn,mt="3.21.0",ln=be,dn=Rr,mn=Se.escapeFacetValue,vn=Ye,gn=se,pn=Ee,Rn=Oe,vt=et,yn=tt,M=Sr,Ae=it,_e=dt,Fn=hn,gt=mt;function l(e,t,r,n){typeof e.addAlgoliaAgent=="function"&&e.addAlgoliaAgent("JS Helper ("+gt+")"),this.setClient(e);var i=r||{};i.index=t,this.state=Ae.make(i),this.recommendState=new vt({params:i.recommendState}),this.lastResults=null,this.lastRecommendResults=null,this._queryId=0,this._recommendQueryId=0,this._lastQueryIdReceived=-1,this._lastRecommendQueryIdReceived=-1,this.derivedHelpers=[],this._currentNbQueries=0,this._currentNbRecommendQueries=0,this._searchResultsOptions=n,this._recommendCache={}}vn(l,ln);l.prototype.search=function(){return this._search({onlyWithDerivedHelpers:!1}),this};l.prototype.searchOnlyWithDerivedHelpers=function(){return this._search({onlyWithDerivedHelpers:!0}),this};l.prototype.recommend=function(){return this._recommend(),this};l.prototype.getQuery=function(){var e=this.state;return M._getHitsSearchParams(e)};l.prototype.searchOnce=function(e,t){var r=e?this.state.setQueryParameters(e):this.state,n=M._getQueries(r.index,r),i=this;if(this._currentNbQueries++,this.emit("searchOnce",{state:r}),t){this.client.search(n).then(function(a){i._currentNbQueries--,i._currentNbQueries===0&&i.emit("searchQueueEmpty"),t(null,new _e(r,a.results),r)}).catch(function(a){i._currentNbQueries--,i._currentNbQueries===0&&i.emit("searchQueueEmpty"),t(a,null,r)});return}return this.client.search(n).then(function(a){return i._currentNbQueries--,i._currentNbQueries===0&&i.emit("searchQueueEmpty"),{content:new _e(r,a.results),state:r,_originalResponse:a}},function(a){throw i._currentNbQueries--,i._currentNbQueries===0&&i.emit("searchQueueEmpty"),a})};l.prototype.findAnswers=function(e){console.warn("[algoliasearch-helper] answers is no longer supported");var t=this.state,r=this.derivedHelpers[0];if(!r)return Promise.resolve([]);var n=r.getModifiedState(t),i=gn({attributesForPrediction:e.attributesForPrediction,nbHits:e.nbHits},{params:Rn(M._getHitsSearchParams(n),["attributesToSnippet","hitsPerPage","restrictSearchableAttributes","snippetEllipsisText"])}),a="search for answers was called, but this client does not have a function client.initIndex(index).findAnswers";if(typeof this.client.initIndex!="function")throw new Error(a);var c=this.client.initIndex(n.index);if(typeof c.findAnswers!="function")throw new Error(a);return c.findAnswers(n.query,e.queryLanguages,i)};l.prototype.searchForFacetValues=function(e,t,r,n){var i=typeof this.client.searchForFacetValues=="function",a=typeof this.client.initIndex=="function";if(!i&&!a&&typeof this.client.search!="function")throw new Error("search for facet values (searchable) was called, but this client does not have a function client.searchForFacetValues or client.initIndex(index).searchForFacetValues");var c=this.state.setQueryParameters(n||{}),s=c.isDisjunctiveFacet(e),o=M.getSearchForFacetQuery(e,t,r,c);this._currentNbQueries++;var u=this,f;return i?f=this.client.searchForFacetValues([{indexName:c.index,params:o}]):a?f=this.client.initIndex(c.index).searchForFacetValues(o):(delete o.facetName,f=this.client.search([{type:"facet",facet:e,indexName:c.index,params:o}]).then(function(m){return m.results[0]})),this.emit("searchForFacetValues",{state:c,facet:e,query:t}),f.then(function(m){return u._currentNbQueries--,u._currentNbQueries===0&&u.emit("searchQueueEmpty"),m=Array.isArray(m)?m[0]:m,m.facetHits.forEach(function(v){v.escapedValue=mn(v.value),v.isRefined=s?c.isDisjunctiveFacetRefined(e,v.escapedValue):c.isFacetRefined(e,v.escapedValue)}),m},function(d){throw u._currentNbQueries--,u._currentNbQueries===0&&u.emit("searchQueueEmpty"),d})};l.prototype.setQuery=function(e){return this._change({state:this.state.resetPage().setQuery(e),isPageReset:!0}),this};l.prototype.clearRefinements=function(e){return this._change({state:this.state.resetPage().clearRefinements(e),isPageReset:!0}),this};l.prototype.clearTags=function(){return this._change({state:this.state.resetPage().clearTags(),isPageReset:!0}),this};l.prototype.addDisjunctiveFacetRefinement=function(e,t){return this._change({state:this.state.resetPage().addDisjunctiveFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.addDisjunctiveRefine=function(){return this.addDisjunctiveFacetRefinement.apply(this,arguments)};l.prototype.addHierarchicalFacetRefinement=function(e,t){return this._change({state:this.state.resetPage().addHierarchicalFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.addNumericRefinement=function(e,t,r){return this._change({state:this.state.resetPage().addNumericRefinement(e,t,r),isPageReset:!0}),this};l.prototype.addFacetRefinement=function(e,t){return this._change({state:this.state.resetPage().addFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.addRefine=function(){return this.addFacetRefinement.apply(this,arguments)};l.prototype.addFacetExclusion=function(e,t){return this._change({state:this.state.resetPage().addExcludeRefinement(e,t),isPageReset:!0}),this};l.prototype.addExclude=function(){return this.addFacetExclusion.apply(this,arguments)};l.prototype.addTag=function(e){return this._change({state:this.state.resetPage().addTagRefinement(e),isPageReset:!0}),this};l.prototype.addFrequentlyBoughtTogether=function(e){return this._recommendChange({state:this.recommendState.addFrequentlyBoughtTogether(e)}),this};l.prototype.addRelatedProducts=function(e){return this._recommendChange({state:this.recommendState.addRelatedProducts(e)}),this};l.prototype.addTrendingItems=function(e){return this._recommendChange({state:this.recommendState.addTrendingItems(e)}),this};l.prototype.addTrendingFacets=function(e){return this._recommendChange({state:this.recommendState.addTrendingFacets(e)}),this};l.prototype.addLookingSimilar=function(e){return this._recommendChange({state:this.recommendState.addLookingSimilar(e)}),this};l.prototype.removeNumericRefinement=function(e,t,r){return this._change({state:this.state.resetPage().removeNumericRefinement(e,t,r),isPageReset:!0}),this};l.prototype.removeDisjunctiveFacetRefinement=function(e,t){return this._change({state:this.state.resetPage().removeDisjunctiveFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.removeDisjunctiveRefine=function(){return this.removeDisjunctiveFacetRefinement.apply(this,arguments)};l.prototype.removeHierarchicalFacetRefinement=function(e){return this._change({state:this.state.resetPage().removeHierarchicalFacetRefinement(e),isPageReset:!0}),this};l.prototype.removeFacetRefinement=function(e,t){return this._change({state:this.state.resetPage().removeFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.removeRefine=function(){return this.removeFacetRefinement.apply(this,arguments)};l.prototype.removeFacetExclusion=function(e,t){return this._change({state:this.state.resetPage().removeExcludeRefinement(e,t),isPageReset:!0}),this};l.prototype.removeExclude=function(){return this.removeFacetExclusion.apply(this,arguments)};l.prototype.removeTag=function(e){return this._change({state:this.state.resetPage().removeTagRefinement(e),isPageReset:!0}),this};l.prototype.removeFrequentlyBoughtTogether=function(e){return this._recommendChange({state:this.recommendState.removeParams(e)}),this};l.prototype.removeRelatedProducts=function(e){return this._recommendChange({state:this.recommendState.removeParams(e)}),this};l.prototype.removeTrendingItems=function(e){return this._recommendChange({state:this.recommendState.removeParams(e)}),this};l.prototype.removeTrendingFacets=function(e){return this._recommendChange({state:this.recommendState.removeParams(e)}),this};l.prototype.removeLookingSimilar=function(e){return this._recommendChange({state:this.recommendState.removeParams(e)}),this};l.prototype.toggleFacetExclusion=function(e,t){return this._change({state:this.state.resetPage().toggleExcludeFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.toggleExclude=function(){return this.toggleFacetExclusion.apply(this,arguments)};l.prototype.toggleRefinement=function(e,t){return this.toggleFacetRefinement(e,t)};l.prototype.toggleFacetRefinement=function(e,t){return this._change({state:this.state.resetPage().toggleFacetRefinement(e,t),isPageReset:!0}),this};l.prototype.toggleRefine=function(){return this.toggleFacetRefinement.apply(this,arguments)};l.prototype.toggleTag=function(e){return this._change({state:this.state.resetPage().toggleTagRefinement(e),isPageReset:!0}),this};l.prototype.nextPage=function(){var e=this.state.page||0;return this.setPage(e+1)};l.prototype.previousPage=function(){var e=this.state.page||0;return this.setPage(e-1)};function pt(e){if(e<0)throw new Error("Page requested below 0.");return this._change({state:this.state.setPage(e),isPageReset:!1}),this}l.prototype.setCurrentPage=pt;l.prototype.setPage=pt;l.prototype.setIndex=function(e){return this._change({state:this.state.resetPage().setIndex(e),isPageReset:!0}),this};l.prototype.setQueryParameter=function(e,t){return this._change({state:this.state.resetPage().setQueryParameter(e,t),isPageReset:!0}),this};l.prototype.setState=function(e){return this._change({state:Ae.make(e),isPageReset:!1}),this};l.prototype.overrideStateWithoutTriggeringChangeEvent=function(e){return this.state=new Ae(e),this};l.prototype.hasRefinements=function(e){return pn(this.state.getNumericRefinements(e))?!0:this.state.isConjunctiveFacet(e)?this.state.isFacetRefined(e):this.state.isDisjunctiveFacet(e)?this.state.isDisjunctiveFacetRefined(e):this.state.isHierarchicalFacet(e)?this.state.isHierarchicalFacetRefined(e):!1};l.prototype.isExcluded=function(e,t){return this.state.isExcludeRefined(e,t)};l.prototype.isDisjunctiveRefined=function(e,t){return this.state.isDisjunctiveFacetRefined(e,t)};l.prototype.hasTag=function(e){return this.state.isTagRefined(e)};l.prototype.isTagRefined=function(){return this.hasTagRefinements.apply(this,arguments)};l.prototype.getIndex=function(){return this.state.index};function Rt(){return this.state.page}l.prototype.getCurrentPage=Rt;l.prototype.getPage=Rt;l.prototype.getTags=function(){return this.state.tagRefinements};l.prototype.getRefinements=function(e){var t=[];if(this.state.isConjunctiveFacet(e)){var r=this.state.getConjunctiveRefinements(e);r.forEach(function(c){t.push({value:c,type:"conjunctive"})});var n=this.state.getExcludeRefinements(e);n.forEach(function(c){t.push({value:c,type:"exclude"})})}else if(this.state.isDisjunctiveFacet(e)){var i=this.state.getDisjunctiveRefinements(e);i.forEach(function(c){t.push({value:c,type:"disjunctive"})})}var a=this.state.getNumericRefinements(e);return Object.keys(a).forEach(function(c){var s=a[c];t.push({value:s,operator:c,type:"numeric"})}),t};l.prototype.getNumericRefinement=function(e,t){return this.state.getNumericRefinement(e,t)};l.prototype.getHierarchicalFacetBreadcrumb=function(e){return this.state.getHierarchicalFacetBreadcrumb(e)};l.prototype._search=function(e){var t=this.state,r=[],n=[];e.onlyWithDerivedHelpers||(n=M._getQueries(t.index,t),r.push({state:t,queriesCount:n.length,helper:this}),this.emit("search",{state:t,results:this.lastResults}));var i=this.derivedHelpers.map(function(s){var o=s.getModifiedState(t),u=o.index?M._getQueries(o.index,o):[];return r.push({state:o,queriesCount:u.length,helper:s}),s.emit("search",{state:o,results:s.lastResults}),u}),a=Array.prototype.concat.apply(n,i),c=this._queryId++;if(this._currentNbQueries++,!a.length)return Promise.resolve({results:[]}).then(this._dispatchAlgoliaResponse.bind(this,r,c));try{this.client.search(a).then(this._dispatchAlgoliaResponse.bind(this,r,c)).catch(this._dispatchAlgoliaError.bind(this,c))}catch(s){this.emit("error",{error:s})}};l.prototype._recommend=function(){var e=this.state,t=this.recommendState,r=this.getIndex(),n=[{state:t,index:r,helper:this}],i=t.params.map(function(u){return u.$$id});this.emit("fetch",{recommend:{state:t,results:this.lastRecommendResults}});var a=this._recommendCache,c=this.derivedHelpers.map(function(u){var f=u.getModifiedState(e).index;if(!f)return[];var d=u.getModifiedRecommendState(new vt);return n.push({state:d,index:f,helper:u}),i=Array.prototype.concat.apply(i,d.params.map(function(m){return m.$$id})),u.emit("fetch",{recommend:{state:d,results:u.lastRecommendResults}}),d._buildQueries(f,a)}),s=Array.prototype.concat.apply(this.recommendState._buildQueries(r,a),c);if(s.length!==0){if(s.length>0&&typeof this.client.getRecommendations>"u"){console.warn("Please update algoliasearch/lite to the latest version in order to use recommend widgets.");return}var o=this._recommendQueryId++;this._currentNbRecommendQueries++;try{this.client.getRecommendations(s).then(this._dispatchRecommendResponse.bind(this,o,n,i)).catch(this._dispatchRecommendError.bind(this,o))}catch(u){this.emit("error",{error:u})}}};l.prototype._dispatchAlgoliaResponse=function(e,t,r){var n=this;if(!(t<this._lastQueryIdReceived)){this._currentNbQueries-=t-this._lastQueryIdReceived,this._lastQueryIdReceived=t,this._currentNbQueries===0&&this.emit("searchQueueEmpty");var i=r.results.slice();e.forEach(function(a){var c=a.state,s=a.queriesCount,o=a.helper,u=i.splice(0,s);if(!c.index){o.emit("result",{results:null,state:c});return}o.lastResults=new _e(c,u,n._searchResultsOptions),o.emit("result",{results:o.lastResults,state:c})})}};l.prototype._dispatchRecommendResponse=function(e,t,r,n){if(!(e<this._lastRecommendQueryIdReceived)){this._currentNbRecommendQueries-=e-this._lastRecommendQueryIdReceived,this._lastRecommendQueryIdReceived=e,this._currentNbRecommendQueries===0&&this.emit("recommendQueueEmpty");var i=this._recommendCache,a={};r.filter(function(s){return i[s]===void 0}).forEach(function(s,o){a[s]||(a[s]=[]),a[s].push(o)}),Object.keys(a).forEach(function(s){var o=a[s],u=n.results[o[0]];if(o.length===1){i[s]=u;return}i[s]=Object.assign({},u,{hits:Fn(o.map(function(f){return n.results[f].hits}))})});var c={};r.forEach(function(s){c[s]=i[s]}),t.forEach(function(s){var o=s.state,u=s.helper;if(!s.index){u.emit("recommend:result",{results:null,state:o});return}u.lastRecommendResults=new yn(o,c),u.emit("recommend:result",{recommend:{results:u.lastRecommendResults,state:o}})})}};l.prototype._dispatchAlgoliaError=function(e,t){e<this._lastQueryIdReceived||(this._currentNbQueries-=e-this._lastQueryIdReceived,this._lastQueryIdReceived=e,this.emit("error",{error:t}),this._currentNbQueries===0&&this.emit("searchQueueEmpty"))};l.prototype._dispatchRecommendError=function(e,t){e<this._lastRecommendQueryIdReceived||(this._currentNbRecommendQueries-=e-this._lastRecommendQueryIdReceived,this._lastRecommendQueryIdReceived=e,this.emit("error",{error:t}),this._currentNbRecommendQueries===0&&this.emit("recommendQueueEmpty"))};l.prototype.containsRefinement=function(e,t,r,n){return e||t.length!==0||r.length!==0||n.length!==0};l.prototype._hasDisjunctiveRefinements=function(e){return this.state.disjunctiveRefinements[e]&&this.state.disjunctiveRefinements[e].length>0};l.prototype._change=function(e){var t=e.state,r=e.isPageReset;t!==this.state&&(this.state=t,this.emit("change",{state:this.state,results:this.lastResults,isPageReset:r}))};l.prototype._recommendChange=function(e){var t=e.state;t!==this.recommendState&&(this.recommendState=t,this.emit("recommend:change",{search:{results:this.lastResults,state:this.state},recommend:{results:this.lastRecommendResults,state:this.recommendState}}))};l.prototype.clearCache=function(){return this.client.clearCache&&this.client.clearCache(),this};l.prototype.setClient=function(e){return this.client===e?this:(typeof e.addAlgoliaAgent=="function"&&e.addAlgoliaAgent("JS Helper ("+gt+")"),this.client=e,this)};l.prototype.getClient=function(){return this.client};l.prototype.derive=function(e,t){var r=new dn(this,e,t);return this.derivedHelpers.push(r),r};l.prototype.detachDerivedHelper=function(e){var t=this.derivedHelpers.indexOf(e);if(t===-1)throw new Error("Derived helper already detached");this.derivedHelpers.splice(t,1)};l.prototype.hasPendingRequests=function(){return this._currentNbQueries>0};var Pn=l,yt=Pn,_n=et,jn=tt,bn=it,Sn=dt;function B(e,t,r,n){return new yt(e,t,r,n)}B.version=mt;B.AlgoliaSearchHelper=yt;B.SearchParameters=bn;B.RecommendParameters=_n;B.SearchResults=Sn;B.RecommendResults=jn;var xn=B;const I=ze(xn);function Zn(e,t){return e.toLocaleString(t)}function X(e){"@babel/helpers - typeof";return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(e)}var En=["initialSearchParameters"],On=["initialRecommendParameters"];function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ke(Object(r),!0).forEach(function(n){U(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U(e,t,r){return t=Hn(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hn(e){var t=wn(e,"string");return X(t)==="symbol"?t:String(t)}function wn(e,t){if(X(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ft(e){return Dn(e)||Qn(e)||Tn(e)||An()}function An(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tn(e,t){if(e){if(typeof e=="string")return je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return je(e,t)}}function Qn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dn(e){if(Array.isArray(e))return je(e)}function je(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pt(e,t){if(e==null)return{};var r=In(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function In(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var k=Vt({name:"index-widget"});function _t(e,t){var r=t.state,n=t.recommendState,i=t.isPageReset,a=t._uiState;r!==e.state&&(e.state=r,e.emit("change",{state:e.state,results:e.lastResults,isPageReset:i,_uiState:a})),n!==e.recommendState&&(e.recommendState=n)}function q(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e.reduce(function(n,i){return Q(i)||!i.getWidgetUiState&&!i.getWidgetState?n:i.getWidgetUiState?i.getWidgetUiState(n,t):i.getWidgetState(n,t)},r)}function z(e,t){var r=t.initialSearchParameters,n=Pt(t,En);return e.reduce(function(i,a){return!a.getWidgetSearchParameters||Q(a)?i:a.dependsOn==="search"&&a.getWidgetParameters?a.getWidgetParameters(i,n):a.getWidgetSearchParameters(i,n)},r)}function qe(e,t){var r=t.initialRecommendParameters,n=Pt(t,On);return e.reduce(function(i,a){return!Q(a)&&a.dependsOn==="recommend"&&a.getWidgetParameters?a.getWidgetParameters(i,n):i},r)}function jt(e){var t=e.filter(Q);t.length!==0&&t.forEach(function(r){var n=r.getHelper();_t(n,{state:n.state.resetPage(),recommendState:n.recommendState,isPageReset:!0}),jt(r.getWidgets())})}function bt(e){var t=e.filter(Q);return t.reduce(function(r,n){return r.concat.apply(r,[{indexId:n.getIndexId(),results:n.getResults(),helper:n.getHelper()}].concat(Ft(bt(n.getWidgets()))))},[])}var $n=function(t){if(t===void 0||t.indexName===void 0)throw new Error(k("The `indexName` option is required."));var r=t.indexName,n=t.indexId,i=n===void 0?r:n,a=[],c={},s=null,o=null,u=null,f=null,d=null,m=!1,v=!1;return{$$type:"ais.index",$$widgetType:"ais.index",getIndexName:function(){return r},getIndexId:function(){return i},getHelper:function(){return u},getResults:function(){var h;return(h=f)!==null&&h!==void 0&&h.lastResults?(f.lastResults._state=u.state,f.lastResults):null},getResultsForWidget:function(h){var p;return h.dependsOn!=="recommend"||Q(h)||h.$$id===void 0?this.getResults():(p=u)!==null&&p!==void 0&&p.lastRecommendResults?u.lastRecommendResults[h.$$id]:null},getPreviousState:function(){return d},getScopedResults:function(){var h=this.getParent(),p;return h?p=h.getWidgets():r.length===0?p=this.getWidgets():p=[this],bt(p)},getParent:function(){return o},createURL:function(h){return typeof h=="function"?s._createURL(U({},i,h(c))):s._createURL(U({},i,q(a,{searchParameters:h,helper:u})))},getWidgets:function(){return a},addWidgets:function(h){var p=this;if(!Array.isArray(h))throw new Error(k("The `addWidgets` method expects an array of widgets."));if(h.some(function(g){return typeof g.init!="function"&&typeof g.render!="function"}))throw new Error(k("The widget definition expects a `render` and/or an `init` method."));return h.forEach(function(g){Q(g)||(s&&g.dependsOn==="recommend"?s._hasRecommendWidget=!0:s?s._hasSearchWidget=!0:g.dependsOn==="recommend"?m=!0:v=!0,Ht(g))}),a=a.concat(h),s&&h.length&&(_t(u,{state:z(a,{uiState:c,initialSearchParameters:u.state}),recommendState:qe(a,{uiState:c,initialRecommendParameters:u.recommendState}),_uiState:c}),h.forEach(function(g){if(g.getRenderState){var R=g.getRenderState(s.renderState[p.getIndexId()]||{},te(s,p,s._initialUiState));ve({renderState:R,instantSearchInstance:s,parent:p})}}),h.forEach(function(g){g.init&&g.init(te(s,p,s._initialUiState))}),s.scheduleSearch()),this},removeWidgets:function(h){var p=this;if(!Array.isArray(h))throw new Error(k("The `removeWidgets` method expects an array of widgets."));if(h.some(function(P){return typeof P.dispose!="function"}))throw new Error(k("The widget definition expects a `dispose` method."));if(a=a.filter(function(P){return h.indexOf(P)===-1}),a.forEach(function(P){Q(P)||(s&&P.dependsOn==="recommend"?s._hasRecommendWidget=!0:s?s._hasSearchWidget=!0:P.dependsOn==="recommend"?m=!0:v=!0)}),s&&h.length){var g=h.reduce(function(P,N){var A=N.dispose({helper:u,state:P.cleanedSearchState,recommendState:P.cleanedRecommendState,parent:p});return A instanceof I.RecommendParameters?P.cleanedRecommendState=A:A&&(P.cleanedSearchState=A),P},{cleanedSearchState:u.state,cleanedRecommendState:u.recommendState}),R=g.cleanedSearchState,j=g.cleanedRecommendState,F=s.future.preserveSharedStateOnUnmount?z(a,{uiState:c,initialSearchParameters:new I.SearchParameters({index:this.getIndexName()})}):z(a,{uiState:q(a,{searchParameters:R,helper:u}),initialSearchParameters:R});c=q(a,{searchParameters:F,helper:u}),u.setState(F),u.recommendState=j,a.length&&s.scheduleSearch()}return this},init:function(h){var p=this,g,R=h.instantSearchInstance,j=h.parent,F=h.uiState;if(u===null){s=R,o=j,c=F[i]||{};var P=R.mainHelper,N=z(a,{uiState:c,initialSearchParameters:new I.SearchParameters({index:r})}),A=qe(a,{uiState:c,initialRecommendParameters:new I.RecommendParameters});u=I({},N.index,N),u.recommendState=A,u.search=function(){return R.onStateChange?(R.onStateChange({uiState:R.mainIndex.getWidgetUiState({}),setUiState:function(S){return R.setUiState(S,!1)}}),P):P.search()},u.searchWithoutTriggeringOnStateChange=function(){return P.search()},u.searchForFacetValues=function(b,S,ce,St){var xt=u.state.setQueryParameters(St);return P.searchForFacetValues(b,S,ce,xt)},f=P.derive(function(){return hr.apply(void 0,[P.state].concat(Ft(lr(p))))},function(){return p.getHelper().recommendState});var H=(g=R._initialResults)===null||g===void 0?void 0:g[this.getIndexId()];if(H!=null&&H.results){var Te=new I.SearchResults(new I.SearchParameters(H.state),H.results);f.lastResults=Te,u.lastResults=Te}if(H!=null&&H.recommendResults){var Qe=new I.RecommendResults(new I.RecommendParameters({params:H.recommendResults.params}),H.recommendResults.results);f.lastRecommendResults=Qe,u.lastRecommendResults=Qe}u.on("change",function(b){var S=b.isPageReset;S&&jt(a)}),f.on("search",function(){R.scheduleStalledRender()}),f.on("result",function(b){var S=b.results;R.scheduleRender(),u.lastResults=S,d=S?._state}),f.on("recommend:result",function(b){var S=b.recommend;R.scheduleRender(),u.lastRecommendResults=S.results}),a.forEach(function(b){if(b.getRenderState){var S=b.getRenderState(R.renderState[p.getIndexId()]||{},te(R,p,F));ve({renderState:S,instantSearchInstance:R,parent:p})}}),a.forEach(function(b){b.init&&b.init(te(R,p,F))}),u.on("change",function(b){var S=b.state,ce=b._uiState;c=q(a,{searchParameters:S,helper:u},ce||{}),R.onStateChange||R.onInternalStateChange()}),H&&R.scheduleRender(),m&&(R._hasRecommendWidget=!0),v&&(R._hasSearchWidget=!0)}},render:function(h){var p,g=this,R=h.instantSearchInstance;R.status==="error"&&!R.mainHelper.hasPendingRequests()&&d&&u.setState(d);var j=this.getResults()||(p=f)!==null&&p!==void 0&&p.lastRecommendResults?a:a.filter(Q);j=j.filter(function(F){return F.shouldRender?F.shouldRender({instantSearchInstance:R}):!0}),j.forEach(function(F){if(F.getRenderState){var P=F.getRenderState(R.renderState[g.getIndexId()]||{},Ne(R,g,F));ve({renderState:P,instantSearchInstance:R,parent:g})}}),j.forEach(function(F){F.render&&F.render(Ne(R,g,F))})},dispose:function(){var h=this,p,g;a.forEach(function(R){R.dispose&&u&&R.dispose({helper:u,state:u.state,recommendState:u.recommendState,parent:h})}),s=null,o=null,(p=u)===null||p===void 0||p.removeAllListeners(),u=null,(g=f)===null||g===void 0||g.detach(),f=null},getWidgetUiState:function(h){return a.filter(Q).reduce(function(p,g){return g.getWidgetUiState(p)},T(T({},h),{},U({},i,T(T({},h[i]),c))))},getWidgetState:function(h){return this.getWidgetUiState(h)},getWidgetSearchParameters:function(h,p){var g=p.uiState;return z(a,{uiState:g,initialSearchParameters:h})},refreshUiState:function(){c=q(a,{searchParameters:this.getHelper().state,helper:this.getHelper()},c)},setIndexUiState:function(h){var p=typeof h=="function"?h(c):h;s.setUiState(function(g){return T(T({},g),{},U({},i,p))})}}};const Xn=$n;function ve(e){var t=e.renderState,r=e.instantSearchInstance,n=e.parent,i=n?n.getIndexId():r.mainIndex.getIndexId();r.renderState=T(T({},r.renderState),{},U({},i,T(T({},r.renderState[i]),t)))}export{Gn as E,re as T,kn as a,qt as b,Nn as c,te as d,Zn as e,Vn as f,qn as g,Kn as h,Q as i,Vt as j,Xn as k,I as l,Bn as m,Wn as n,Lt as o,zt as p,Un as q,hr as r,zn as s,Ct as t,Ln as u,Ie as v,Jn as w,Ut as x,Mn as y};
